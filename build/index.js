/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/index.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/config.js":
/*!***********************!*\
  !*** ./src/config.js ***!
  \***********************/
/*! exports provided: permissions, roles, accountStatus, accountType, offices, titles, emailGroups */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"permissions\", function() { return permissions; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"roles\", function() { return roles; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"accountStatus\", function() { return accountStatus; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"accountType\", function() { return accountType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"offices\", function() { return offices; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"titles\", function() { return titles; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"emailGroups\", function() { return emailGroups; });\n// Deprecated in favor of roles\nvar permissions = [\"DASHBOARD_AREA\", // All except locked/inactive/resigned/removed\n\"ADMIN_AREA\", // Board, admin\n\"VOTE_READ\", // Full member\n\"USER_DELETE\", // Admin\n\"ROSTER_READ\", // Full members, emeritus, board, admin\n\"PERMISSION_UPDATE\" // Admin\n];\nvar roles = [\"ADMIN\", // Manage permissions\n\"OFFICER\", // Administrative area\n\"RUN_MASTER\", // Able to create events\n\"RUN_LEADER\", // Able to view extra event details, log run report\n\"USER\" // DEFAULT\n];\nvar accountStatus = [\"ACTIVE\", \"PAST_DUE\", // account overdue - active, must pay\n\"DELINQUENT\", // account 3 months to 1 year overdue - locked, contact, must pay\n\"INACTIVE\", // account 1+ year overdue - locked, contact\n\"REMOVED\", // cannot do anything - locked, contact\n\"RESIGNED\", // cannot do anything - locked, contact\n\"LIMITED\", // attended too many runs - locked, must become member\n\"LOCKED\" // DEFAULT - must be approved\n];\nvar accountType = [\"FULL\", \"ASSOCIATE\", // No voting rights, no member's only events/discussion\n\"EMERITUS\", // Same as Associate\n\"GUEST\" // DEFAULT - confirmed user. No roster, no voting rights, no member's only events/discussion\n];\nvar offices = {\n  PRESIDENT: \"President\",\n  // unique\n  VICE_PRESIDENT: \"Vice President\",\n  // unique\n  SECRETARY: \"Secretary\",\n  // unique\n  TREASURER: \"Treasurer\" // unique\n\n};\nvar titles = {\n  WEBMASTER: \"Webmaster\",\n  // unique\n  RUN_MASTER: \"Run Master\",\n  // unique\n  RUN_LEADER: \"Run Leader\",\n  EMERITUS_MEMBER: \"Emeritus Member\",\n  CHARTER_MEMBER: \"Charter Member\"\n};\nvar emailGroups = [\"officers\", \"runmaster\", \"webmaster\", \"run_leaders\", \"full_membership\", // Membership announcement, membership newsletter\n\"all_active\", // Events, general announcements\n\"guests\", \"all_users\" // EVERYONE EVER\n];\n/**\n * Check Logged-in\n * Check Role\n * Check Account Status\n */\n\n//# sourceURL=webpack:///./src/config.js?");

/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"@babel/runtime/regenerator\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ \"@babel/runtime/helpers/asyncToGenerator\");\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"@babel/runtime/helpers/defineProperty\");\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var dotenv__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! dotenv */ \"dotenv\");\n/* harmony import */ var dotenv__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(dotenv__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var apollo_server_express__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! apollo-server-express */ \"apollo-server-express\");\n/* harmony import */ var apollo_server_express__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(apollo_server_express__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var cookie_parser__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! cookie-parser */ \"cookie-parser\");\n/* harmony import */ var cookie_parser__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(cookie_parser__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var cors__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! cors */ \"cors\");\n/* harmony import */ var cors__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(cors__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var prisma_binding__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! prisma-binding */ \"prisma-binding\");\n/* harmony import */ var prisma_binding__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(prisma_binding__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var graphql_import__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! graphql-import */ \"graphql-import\");\n/* harmony import */ var graphql_import__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(graphql_import__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var _resolvers_Mutation__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./resolvers/Mutation */ \"./src/resolvers/Mutation.js\");\n/* harmony import */ var _resolvers_Query__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./resolvers/Query */ \"./src/resolvers/Query.js\");\n/* harmony import */ var _resolvers_Election__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./resolvers/Election */ \"./src/resolvers/Election.js\");\n/* harmony import */ var _resolvers_Ballot__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./resolvers/Ballot */ \"./src/resolvers/Ballot.js\");\n/* harmony import */ var _resolvers_Trail__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./resolvers/Trail */ \"./src/resolvers/Trail.js\");\n\n\n\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2___default()(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n\nObject(dotenv__WEBPACK_IMPORTED_MODULE_3__[\"config\"])({\n  path: \"variables.env\"\n});\n\n\n\n\n\n\n\n\n\n\n\n // const { typeDefs: prismaTypeDefs } = require(\"./generated/prisma-schema\");\n// const isLambda = process.env.LAMBDA_TASK_ROOT;\n// const src = isLambda ? `${isLambda}/bundle` : \"src\";\n// const generalTypeDefs = importSchema(require.resolve(\"./schema.graphql\"));\n// const prismaTypeDefs = importSchema(require__dirname.concat(\"/generated/prisma.graphql\"));\n\nvar generalTypeDefs = Object(graphql_import__WEBPACK_IMPORTED_MODULE_10__[\"importSchema\"])(\"./schema.graphql\"); // const generalTypeDefs = importSchema(\"./src/generated/prisma.graphql\");\n// import generalTypeDefs from \"./src/schema.graphql\";\n// import prismaTypeDefs from \"./generated/prisma.graphql\";\n\nvar db = new prisma_binding__WEBPACK_IMPORTED_MODULE_9__[\"Prisma\"]({\n  typeDefs: \"./src/generated/prisma.graphql\",\n  endpoint: process.env.PRISMA_ENDPOINT,\n  secret: process.env.PRISMA_SECRET,\n  debug: \"development\" === \"development\"\n});\n/*\n\"- /var/task/bundle/index.js\",\n\"- /var/task/graphql.js\",\n\"- /var/runtime/UserFunction.js\",\n\"- /var/runtime/index.js\",\n*/\n\nvar corsOptions = {\n  credentials: true,\n  origin: process.env.FRONTEND_URL\n};\nvar schema = Object(apollo_server_express__WEBPACK_IMPORTED_MODULE_5__[\"makeExecutableSchema\"])({\n  typeDefs: Object(apollo_server_express__WEBPACK_IMPORTED_MODULE_5__[\"gql\"])(generalTypeDefs),\n  resolvers: {\n    Mutation: _resolvers_Mutation__WEBPACK_IMPORTED_MODULE_11__[\"default\"],\n    Query: _resolvers_Query__WEBPACK_IMPORTED_MODULE_12__[\"default\"],\n    Trail: _resolvers_Trail__WEBPACK_IMPORTED_MODULE_15__[\"default\"],\n    Election: _resolvers_Election__WEBPACK_IMPORTED_MODULE_13__[\"default\"],\n    Ballot: _resolvers_Ballot__WEBPACK_IMPORTED_MODULE_14__[\"default\"]\n  },\n  resolverValidationOptions: {\n    requireResolversForResolveType: false\n  }\n}); // Create GraphQL server\n// const createServer = () => {\n//   //   typeDefs: \"src/schema.graphql\",\n//   return new ApolloServer({\n//     schema,\n//     context: req => ({ ...req, db })\n//   });\n// };\n\nvar app = express__WEBPACK_IMPORTED_MODULE_4___default()(); // const server = createServer();\n// Create GraphQL server\n\nvar server = new apollo_server_express__WEBPACK_IMPORTED_MODULE_5__[\"ApolloServer\"]({\n  schema: schema,\n  context: function context(req) {\n    return _objectSpread(_objectSpread({}, req), {}, {\n      db: db\n    });\n  }\n}); // Daily Automation:::\n// Automatically change Active Full Member status to Past Due\n//   if no dues received after 1/1 of each year\n//   and send email, tag as 'past due'\n// Automatically change Past Due Full Member status to Delinquent\n//   if no dues received after 3/31 of each year\n//   and send email, remove from members list, remove 'past due' tag\n// Automatically change Delinquent Full Member status to Inactive\n//   if no dues received in the last year\n//   and send email\n// Transactional Emails:\n// - Event Reminders (if RSVP yes, 1 day in advance) to attendees\n// - Post run: Run Report/Bandaid Report to run leader\n// - Post run: Review/Photos to attendees\n// - Daily: Locked accounts reminder to secretary/webmaster\n// Transactional Events:::\n// - Post run report: Notify board of report\n// - Post run report: Change Active Guest status to Limited if 3 runs attended, notify board\n\napp.use(cors__WEBPACK_IMPORTED_MODULE_8___default()(corsOptions));\napp.use(cookie_parser__WEBPACK_IMPORTED_MODULE_6___default()()); // Decode the JWT to get user ID on each request\n\napp.use( /*#__PURE__*/function () {\n  var _ref = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee(req, res, next) {\n    var token, _jwt$verify, userId;\n\n    return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            token = req.cookies.token;\n\n            if (token) {\n              _jwt$verify = jsonwebtoken__WEBPACK_IMPORTED_MODULE_7___default.a.verify(token, process.env.JWT_SECRET), userId = _jwt$verify.userId;\n              req.userId = userId;\n            }\n\n            next();\n\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}()); // See info about the user if logged in\n\napp.use( /*#__PURE__*/function () {\n  var _ref2 = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee2(req, res, next) {\n    var user;\n    return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (req.userId) {\n              _context2.next = 2;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", next());\n\n          case 2:\n            _context2.next = 4;\n            return db.query.user({\n              where: {\n                id: req.userId\n              }\n            }, \"{ id, role, accountType, accountStatus, email, firstName, lastName, username }\");\n\n          case 4:\n            user = _context2.sent;\n            req.user = user;\n            next();\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x4, _x5, _x6) {\n    return _ref2.apply(this, arguments);\n  };\n}());\nserver.applyMiddleware({\n  app: app,\n  cors: false\n});\n\nif (true) {\n  app.listen({\n    port: 4000\n  }, function () {\n    return console.log(\"\\uD83D\\uDE80 Server ready at http://localhost:4000\".concat(server.graphqlPath));\n  });\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (app);\n\n//# sourceURL=webpack:///./src/index.js?");

/***/ }),

/***/ "./src/mail.js":
/*!*********************!*\
  !*** ./src/mail.js ***!
  \*********************/
/*! exports provided: sendTransactionalEmail */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"sendTransactionalEmail\", function() { return sendTransactionalEmail; });\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"@babel/runtime/regenerator\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"@babel/runtime/helpers/defineProperty\");\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ \"@babel/runtime/helpers/asyncToGenerator\");\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _sendgrid_mail__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sendgrid/mail */ \"@sendgrid/mail\");\n/* harmony import */ var _sendgrid_mail__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_sendgrid_mail__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var nodemailer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! nodemailer */ \"nodemailer\");\n/* harmony import */ var nodemailer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(nodemailer__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default()(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n\n\n_sendgrid_mail__WEBPACK_IMPORTED_MODULE_3___default.a.setApiKey(process.env.SENDGRID_API_KEY);\nvar sendTransactionalEmail = /*#__PURE__*/function () {\n  var _ref = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee(emailData) {\n    var mailSettings, data, transport, mailOptions;\n    return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            mailSettings = {};\n\n            if (true) {\n              _context.next = 6;\n              break;\n            }\n\n            // This will send the email in sandbox mode\n            // mailSettings.mail_settings = {\n            //   sandbox_mode: {\n            //     enable: true,\n            //   },\n            // };\n            data = _objectSpread(_objectSpread({}, emailData), mailSettings);\n            return _context.abrupt(\"return\", _sendgrid_mail__WEBPACK_IMPORTED_MODULE_3___default.a.send(data));\n\n          case 6:\n            transport = nodemailer__WEBPACK_IMPORTED_MODULE_4___default.a.createTransport({\n              host: \"smtp.mailtrap.io\",\n              port: 2525,\n              auth: {\n                user: \"00abda4abf8551\",\n                //generated by Mailtrap\n                pass: \"82046488050e87\" //generated by Mailtrap\n\n              }\n            });\n            mailOptions = _objectSpread({\n              from: \"no-reply@4-playersofcolorado.org\"\n            }, emailData);\n            return _context.abrupt(\"return\", transport.sendMail(mailOptions, function (error, info) {\n              if (error) {\n                throw new Error(error);\n              }\n\n              var msg = \"Message sent\";\n              console.log(\"\".concat(msg, \": \").concat(info.messageId));\n              return Promise.resolve(msg);\n            }));\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function sendTransactionalEmail(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\n//# sourceURL=webpack:///./src/mail.js?");

/***/ }),

/***/ "./src/resolvers/Ballot.js":
/*!*********************************!*\
  !*** ./src/resolvers/Ballot.js ***!
  \*********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"@babel/runtime/regenerator\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"@babel/runtime/helpers/toConsumableArray\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ \"@babel/runtime/helpers/asyncToGenerator\");\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nvar Ballot = {\n  // Pattern borrowed from playbook:\n  // https://www.prisma.io/tutorials/a-guide-to-common-resolver-patterns-ct08/#scenario:-add-a-custom/computed-field-to-a-prisma-model-via-the-application-schema-prisma-bindings\n  results: function results(_ref, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee() {\n      var id, votes, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              id = _ref.id;\n              _context.next = 3;\n              return ctx.db.query.votes({\n                where: {\n                  ballot: {\n                    id: id\n                  }\n                }\n              }, info);\n\n            case 3:\n              votes = _context.sent;\n              results = votes.reduce(function (accumulator, vote) {\n                var entryExists = false; // Does this entry exist in accumulator yet?\n\n                var existingResults = accumulator.map(function (entry) {\n                  if (vote.candidate === null && entry.candidate === null || vote.candidate !== null && entry.candidate !== null && entry.candidate.id === vote.candidate.id) {\n                    entry.count++;\n                    entryExists = true;\n                  }\n\n                  return entry;\n                });\n                return entryExists ? _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(existingResults) : [].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(accumulator), [{\n                  count: 1,\n                  candidate: vote.candidate\n                }]);\n              }, []);\n              return _context.abrupt(\"return\", results.sort(function (a, b) {\n                if (a.count < b.count) {\n                  return 1;\n                }\n\n                if (a.count > b.count) {\n                  return -1;\n                }\n\n                return 0;\n              }));\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  }\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (Ballot);\n\n//# sourceURL=webpack:///./src/resolvers/Ballot.js?");

/***/ }),

/***/ "./src/resolvers/Election.js":
/*!***********************************!*\
  !*** ./src/resolvers/Election.js ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var graphql_binding__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! graphql-binding */ \"graphql-binding\");\n/* harmony import */ var graphql_binding__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(graphql_binding__WEBPACK_IMPORTED_MODULE_0__);\n\nvar Election = {\n  races: function races(parent, args, ctx, info) {\n    var fragment = \"fragment Result on Ballot { id }\";\n    return ctx.db.query.ballots({}, Object(graphql_binding__WEBPACK_IMPORTED_MODULE_0__[\"addFragmentToInfo\"])(info, fragment));\n  }\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (Election);\n\n//# sourceURL=webpack:///./src/resolvers/Election.js?");

/***/ }),

/***/ "./src/resolvers/Mutation.js":
/*!***********************************!*\
  !*** ./src/resolvers/Mutation.js ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"@babel/runtime/helpers/toConsumableArray\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"@babel/runtime/helpers/slicedToArray\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"@babel/runtime/helpers/defineProperty\");\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _babel_runtime_helpers_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/objectWithoutProperties */ \"@babel/runtime/helpers/objectWithoutProperties\");\n/* harmony import */ var _babel_runtime_helpers_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"@babel/runtime/regenerator\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ \"@babel/runtime/helpers/asyncToGenerator\");\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! bcryptjs */ \"bcryptjs\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! util */ \"util\");\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(util__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var node_fetch__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! node-fetch */ \"node-fetch\");\n/* harmony import */ var node_fetch__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(node_fetch__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var cloudinary__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! cloudinary */ \"cloudinary\");\n/* harmony import */ var cloudinary__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(cloudinary__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var _mail__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../mail */ \"./src/mail.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../utils */ \"./src/utils/index.js\");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../config */ \"./src/config.js\");\n\n\n\n\n\n\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2___default()(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n\n\n\n\n\n\nvar promisifiedRandomBytes = Object(util__WEBPACK_IMPORTED_MODULE_9__[\"promisify\"])(crypto__WEBPACK_IMPORTED_MODULE_8__[\"randomBytes\"]);\ncloudinary__WEBPACK_IMPORTED_MODULE_11__[\"v2\"].config({\n  cloud_name: process.env.CLOUNDINARY_NAME,\n  api_key: process.env.CLOUDINARY_KEY,\n  api_secret: process.env.CLOUDINARY_SECRET\n});\nvar promisifiedUpload = Object(util__WEBPACK_IMPORTED_MODULE_9__[\"promisify\"])(cloudinary__WEBPACK_IMPORTED_MODULE_11__[\"v2\"].uploader.unsigned_upload);\nvar promisifiedDestroy = Object(util__WEBPACK_IMPORTED_MODULE_9__[\"promisify\"])(cloudinary__WEBPACK_IMPORTED_MODULE_11__[\"v2\"].uploader.destroy);\nvar HASH_SECRET = process.env.HASH_SECRET;\nvar JWT_SECRET = process.env.JWT_SECRET;\n\n\n\n\nvar getHash = /*#__PURE__*/function () {\n  var _ref = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee(pw) {\n    var salt;\n    return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return bcryptjs__WEBPACK_IMPORTED_MODULE_6___default.a.hash(HASH_SECRET, 10);\n\n          case 2:\n            salt = _context.sent;\n            return _context.abrupt(\"return\", bcryptjs__WEBPACK_IMPORTED_MODULE_6___default.a.hash(pw, salt));\n\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function getHash(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar tokenSettings = {\n  httpOnly: true,\n  maxAge: _utils__WEBPACK_IMPORTED_MODULE_13__[\"yearInMs\"]\n};\nvar Mutation = {\n  register: function register(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee2() {\n      var firstName, lastName, email, confirmEmail, source, lowercaseEmail, lowercaseConfirmEmail, resetToken, emailDetails;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              firstName = args.firstName, lastName = args.lastName, email = args.email, confirmEmail = args.confirmEmail, source = args.source;\n              lowercaseEmail = email.toLowerCase();\n              lowercaseConfirmEmail = confirmEmail.toLowerCase(); // VALIDATION\n\n              if (email) {\n                _context2.next = 5;\n                break;\n              }\n\n              throw new Error(\"Email is required\");\n\n            case 5:\n              if (!(lowercaseEmail !== lowercaseConfirmEmail)) {\n                _context2.next = 7;\n                break;\n              }\n\n              throw new Error(\"Emails do not match\");\n\n            case 7:\n              _context2.next = 9;\n              return promisifiedRandomBytes(20);\n\n            case 9:\n              resetToken = _context2.sent.toString(\"hex\");\n              _context2.next = 12;\n              return ctx.db.mutation.createRegistration({\n                data: {\n                  firstName: firstName,\n                  lastName: lastName,\n                  email: lowercaseEmail,\n                  source: source,\n                  token: resetToken,\n                  tokenExpiry: Date.now() + _utils__WEBPACK_IMPORTED_MODULE_13__[\"resetTokenTimeoutInMs\"]\n                }\n              }, info);\n\n            case 12:\n              _context2.t0 = source;\n              _context2.next = _context2.t0 === \"website\" ? 15 : _context2.t0 === \"run\" ? 17 : _context2.t0 === \"meeting\" ? 17 : _context2.t0 === \"admin\" ? 19 : 19;\n              break;\n\n            case 15:\n              // User initiated\n              emailDetails = {\n                to: lowercaseEmail,\n                from: \"no-reply@4-playersofcolorado.org\",\n                subject: \"Your 4-Players Account Registration\",\n                text: \"\\n            \".concat(firstName, \",\\n    \\n            Thanks for opting in!\\n    \\n            Visit this URL to create your profile:\\n            \").concat(process.env.FRONTEND_URL, \"/signup?token=\").concat(resetToken, \"\\n\\n            If you have any questions, please contact webmaster@4-playersofcolorado.org\\n          \"),\n                html: \"\\n            <p>\".concat(firstName, \",</p>\\n    \\n            <p>Thanks for opting in!</p>\\n    \\n            <p>Visit this URL to create your profile:\\n          \").concat(process.env.FRONTEND_URL, \"/signup?token=\").concat(resetToken, \"</p>\\n\\n            <p>If you have any questions, please contact the <a href=\\\"mailto:webmaster@4-playersofcolorado.org\\\">webmaster</a></p>\\n          \")\n              };\n              return _context2.abrupt(\"break\", 20);\n\n            case 17:\n              // User attended meeting\n              emailDetails = {\n                to: lowercaseEmail,\n                from: \"no-reply@4-playersofcolorado.org\",\n                subject: \"Invitation to register at the 4-Players website\",\n                text: \"\\n          Hi \".concat(firstName, \",\\n  \\n          You recently attended a 4-Players of Colorado event as a guest and have been invited to create an account on the 4-Players website.\\n  \\n          Visit this URL to create your profile:\\n          \").concat(process.env.FRONTEND_URL, \"/signup?token=\").concat(resetToken, \"\\n\\n          If you have any questions, please contact webmaster@4-playersofcolorado.org\\n\\n          If this message was sent to you in error, kindly disregard.\\n        \"),\n                html: \"\\n          <p>Hi \".concat(firstName, \",</p>\\n  \\n          <p>You recently attended a 4-Players of Colorado event as a guest and have been invited to create an account on the 4-Players website.</p>\\n\\n          <p>Visit this URL to create your profile:\\n        \").concat(process.env.FRONTEND_URL, \"/signup?token=\").concat(resetToken, \"</p>\\n\\n          <p>If you have any questions, please contact the <a href=\\\"mailto:webmaster@4-playersofcolorado.org\\\">webmaster</a></p>\\n\\n          <p><small>If this message was sent to you in error, kindly disregard.</small></p>\\n        \")\n              };\n              return _context2.abrupt(\"break\", 20);\n\n            case 19:\n              emailDetails = {\n                to: lowercaseEmail,\n                from: \"no-reply@4-playersofcolorado.org\",\n                subject: \"Invitation to register at the 4-Players website\",\n                text: \"\\n            Hi \".concat(firstName, \",\\n    \\n            You've been invited by \").concat(ctx.req.user.firstName, \" to create an account on the 4-Players of Colorado website.\\n    \\n            Visit this URL to create your profile:\\n            \").concat(process.env.FRONTEND_URL, \"/signup?token=\").concat(resetToken, \"\\n\\n            If you have any questions, please contact webmaster@4-playersofcolorado.org\\n\\n            If this message was sent to you in error, kindly disregard.\\n          \"),\n                html: \"\\n            <p>Hi \".concat(firstName, \",</p>\\n    \\n            <p>You've been invited by \").concat(ctx.req.user.firstName, \" to create an account on the 4-Players of Colorado website.</p>\\n\\n            <p>Visit this URL to create your profile:\\n          \").concat(process.env.FRONTEND_URL, \"/signup?token=\").concat(resetToken, \"</p>\\n\\n            <p>If you have any questions, please contact the <a href=\\\"mailto:webmaster@4-playersofcolorado.org\\\">webmaster</a></p>\\n\\n            <p><small>If this message was sent to you in error, kindly disregard.</small></p>\\n          \")\n              };\n\n            case 20:\n              return _context2.abrupt(\"return\", Object(_mail__WEBPACK_IMPORTED_MODULE_12__[\"sendTransactionalEmail\"])(emailDetails).then(function () {\n                return {\n                  message: \"Registration was successful. Please check your email.\"\n                };\n              })[\"catch\"](function (err) {\n                //Extract error msg\n                // const { message, code, response } = err;\n                //Extract response msg\n                // const { headers, body } = response;\n                throw new Error(err.toString());\n              }));\n\n            case 21:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }))();\n  },\n  signUp: function signUp(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee3() {\n      var email, password, token, firstName, lastName, username, newUser, user;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              email = args.email.toLowerCase(); // VALIDATION\n              // TODO Confirm all fields valid\n              // TODO Lock out if under 18\n              // Hash the password\n\n              _context3.next = 3;\n              return getHash(args.password);\n\n            case 3:\n              password = _context3.sent;\n              token = args.token, firstName = args.firstName, lastName = args.lastName, username = args.username, newUser = _babel_runtime_helpers_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_3___default()(args, [\"token\", \"firstName\", \"lastName\", \"username\"]); // Create user in database\n\n              _context3.prev = 5;\n              _context3.next = 8;\n              return ctx.db.mutation.createUser({\n                data: _objectSpread(_objectSpread({}, newUser), {}, {\n                  email: email,\n                  firstName: firstName,\n                  lastName: lastName,\n                  username: username,\n                  password: password,\n                  lastLogin: new Date(),\n                  membershipLog: {\n                    create: [{\n                      time: new Date(),\n                      message: \"Account created\",\n                      messageCode: \"ACCOUNT_CREATED\"\n                    }]\n                  }\n                })\n              }, info);\n\n            case 8:\n              user = _context3.sent;\n              _context3.next = 11;\n              return ctx.db.mutation.deleteRegistration({\n                where: {\n                  token: token\n                }\n              });\n\n            case 11:\n              return _context3.abrupt(\"return\", Object(_mail__WEBPACK_IMPORTED_MODULE_12__[\"sendTransactionalEmail\"])({\n                to: \"4-Players Secretary <secretary@4-playersofcolorado.org>\",\n                from: \"4-Players Webmaster <no-reply@4-playersofcolorado.org>\",\n                subject: \"[4-Players] New Account Registration\",\n                text: \"\\n        A new guest account has been created:\\n        \".concat(process.env.FRONTEND_URL, \"/profile/\").concat(username, \"\\n      \"),\n                html: \"\\n        <p>A new guest account has been created:\\n        \".concat(process.env.FRONTEND_URL, \"/profile/\").concat(username, \"</p>\\n      \")\n              }).then( // Send email to user\n              Object(_mail__WEBPACK_IMPORTED_MODULE_12__[\"sendTransactionalEmail\"])({\n                to: \"\".concat(firstName, \" \").concat(lastName, \" <\").concat(email, \">\"),\n                from: \"4-Players Webmaster <no-reply@4-playersofcolorado.org>\",\n                subject: \"[4-Players] New Account Registration\",\n                text: \"\\n          Hi \".concat(firstName, \",\\n  \\n          Congratulations! Your new account has been created:\\n          \").concat(process.env.FRONTEND_URL, \"/profile/\").concat(username, \"\\n\\n          The secretary will review your account within 1-2 business days. Please make sure your profile is filled out.\\n        \"),\n                html: \"\\n          <p>Hi \".concat(firstName, \",</p>\\n  \\n          <p>Congratulations! Your new account has been created:\\n          \").concat(process.env.FRONTEND_URL, \"/profile/\").concat(username, \"</p>\\n\\n          <p>The secretary will review your account within 1-2 business days. Please make sure your profile is filled out.</p>\\n        \")\n              })).then(function () {\n                return {\n                  message: \"Account created\"\n                };\n              })[\"catch\"](function (err) {\n                //Extract error msg\n                // const { message, code, response } = err;\n                //Extract response msg\n                // const { headers, body } = response;\n                throw new Error(err);\n              }));\n\n            case 14:\n              _context3.prev = 14;\n              _context3.t0 = _context3[\"catch\"](5);\n\n              if (!(_context3.t0.message === \"A unique constraint would be violated on User. Details: Field name = username\")) {\n                _context3.next = 18;\n                break;\n              }\n\n              throw new Error(\"That username is taken.\");\n\n            case 18:\n              if (!(_context3.t0.message === \"A unique constraint would be violated on User. Details: Field name = email\")) {\n                _context3.next = 20;\n                break;\n              }\n\n              throw new Error(\"There is already an account with that email address. Try resetting your password.\");\n\n            case 20:\n              throw new Error(_context3.t0);\n\n            case 21:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[5, 14]]);\n    }))();\n  },\n  unlockNewAccount: function unlockNewAccount() {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee4() {\n      var logs;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              // Add membership log\n              logs = [{\n                time: new Date(),\n                message: \"Account unlocked by \".concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                messageCode: \"ACCOUNT_UNLOCKED\",\n                logger: {\n                  connect: {\n                    id: ctx.req.userId\n                  }\n                }\n              }]; // Update status\n\n              _context4.next = 3;\n              return ctx.db.mutation.updateUser({\n                data: {\n                  accountStatus: args.accountStatus,\n                  membershipLog: {\n                    create: logs\n                  }\n                },\n                where: {\n                  id: args.userId\n                }\n              }, info);\n\n            case 3:\n              return _context4.abrupt(\"return\", Object(_mail__WEBPACK_IMPORTED_MODULE_12__[\"sendTransactionalEmail\"])({\n                to: lowercaseEmail,\n                from: \"secretary@4-playersofcolorado.org\",\n                subject: \"[4-Players] Account Approval\",\n                text: \"\\n        Welcome, \".concat(firstName, \"!\\n\\n        Thanks for signing up!\\n\\n        Visit this URL to log in:\\n        \").concat(process.env.FRONTEND_URL, \"/login\\n      \"),\n                html: \"\\n        <p>Welcome, \".concat(firstName, \"!</p>\\n\\n        <p>Thanks for signing up!</p>\\n\\n        <p><a href=\\\"\").concat(process.env.FRONTEND_URL, \"/login\\\">Visit the site</a> to log in</p>\\n      \")\n              }).then(function () {\n                return {\n                  message: \"Account unlock successful.\"\n                };\n              })[\"catch\"](function (err) {\n                //Extract error msg\n                // const { message, code, response } = err;\n                //Extract response msg\n                // const { headers, body } = response;\n                throw new Error(err);\n              }));\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }))();\n  },\n  login: function login(parent, _ref2, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee5() {\n      var username, password, user, valid, token;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              username = _ref2.username, password = _ref2.password;\n              _context5.next = 3;\n              return ctx.db.query.user({\n                where: {\n                  username: username\n                }\n              });\n\n            case 3:\n              user = _context5.sent;\n\n              if (user) {\n                _context5.next = 6;\n                break;\n              }\n\n              throw new Error(\"Username or password incorrect\");\n\n            case 6:\n              _context5.next = 8;\n              return bcryptjs__WEBPACK_IMPORTED_MODULE_6___default.a.compare(password, user.password);\n\n            case 8:\n              valid = _context5.sent;\n\n              if (valid) {\n                _context5.next = 11;\n                break;\n              }\n\n              throw new Error(\"Invalid password\");\n\n            case 11:\n              // Generate the JWT token\n              token = jsonwebtoken__WEBPACK_IMPORTED_MODULE_7___default.a.sign({\n                userId: user.id\n              }, process.env.JWT_SECRET); // Set the cookie with the token\n\n              ctx.res.cookie(\"token\", token, tokenSettings); // Update role\n\n              _context5.next = 15;\n              return ctx.db.mutation.updateUser({\n                data: {\n                  lastLogin: new Date()\n                },\n                where: {\n                  id: user.id\n                }\n              }, info);\n\n            case 15:\n              return _context5.abrupt(\"return\", {\n                message: \"Successfully logged in\"\n              });\n\n            case 16:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }))();\n  },\n  logout: function logout(parent, args, ctx, info) {\n    ctx.res.clearCookie(\"token\");\n    return {\n      message: \"Goodbye\"\n    };\n  },\n  requestReset: function requestReset(parent, _ref3, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee6() {\n      var email, user, resetToken, resetTokenExpiry, res;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              email = _ref3.email;\n              _context6.next = 3;\n              return ctx.db.query.user({\n                where: {\n                  email: email\n                }\n              });\n\n            case 3:\n              user = _context6.sent;\n\n              if (user) {\n                _context6.next = 6;\n                break;\n              }\n\n              throw new Error(\"Invalid email entered\");\n\n            case 6:\n              _context6.next = 8;\n              return promisifiedRandomBytes(20);\n\n            case 8:\n              resetToken = _context6.sent.toString(\"hex\");\n              resetTokenExpiry = Date.now() + _utils__WEBPACK_IMPORTED_MODULE_13__[\"resetTokenTimeoutInMs\"];\n              _context6.next = 12;\n              return ctx.db.mutation.updateUser({\n                where: {\n                  email: email\n                },\n                data: {\n                  resetToken: resetToken,\n                  resetTokenExpiry: resetTokenExpiry\n                }\n              });\n\n            case 12:\n              res = _context6.sent;\n              return _context6.abrupt(\"return\", Object(_mail__WEBPACK_IMPORTED_MODULE_12__[\"sendTransactionalEmail\"])({\n                to: user.email,\n                from: \"no-reply@4-playersofcolorado.org\",\n                subject: \"Your 4-Players Password Reset\",\n                text: \"\\n        \".concat(user.firstName, \",\\n\\n        Your password reset token for user \\\"\").concat(user.username, \"\\\" is here!\\n\\n        Visit this URL to reset your password:\\n        \").concat(process.env.FRONTEND_URL, \"/forgot-password?token=\").concat(resetToken, \"\\n      \"),\n                html: \"\\n        Your password reset token for user \\\"\".concat(user.username, \"\\\" is here!\\n        <a href=\\\"\").concat(process.env.FRONTEND_URL, \"/forgot-password?token=\").concat(resetToken, \"\\\">Click here to reset your password</a>\\n      \")\n              }).then(function () {\n                return {\n                  message: \"Password reset is en route\"\n                };\n              })[\"catch\"](function (err) {\n                //Extract error msg\n                // const { message, code, response } = err;\n                //Extract response msg\n                // const { headers, body } = response;\n                throw new Error(err.toString());\n              }));\n\n            case 14:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }))();\n  },\n  resetPassword: function resetPassword(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee7() {\n      var _yield$ctx$db$query$u, _yield$ctx$db$query$u2, user, password, updatedUser, token;\n\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              if (!(args.password !== args.confirmPassword)) {\n                _context7.next = 2;\n                break;\n              }\n\n              throw new Error(\"Passwords do not match\");\n\n            case 2:\n              _context7.next = 4;\n              return ctx.db.query.users({\n                where: {\n                  resetToken: args.resetToken,\n                  resetTokenExpiry_gte: Date.now() - _utils__WEBPACK_IMPORTED_MODULE_13__[\"resetTokenTimeoutInMs\"]\n                }\n              });\n\n            case 4:\n              _yield$ctx$db$query$u = _context7.sent;\n              _yield$ctx$db$query$u2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_yield$ctx$db$query$u, 1);\n              user = _yield$ctx$db$query$u2[0];\n\n              if (user) {\n                _context7.next = 9;\n                break;\n              }\n\n              throw new Error(\"Token invalid or expired\");\n\n            case 9:\n              _context7.next = 11;\n              return getHash(args.password);\n\n            case 11:\n              password = _context7.sent;\n              _context7.next = 14;\n              return ctx.db.mutation.updateUser({\n                where: {\n                  email: user.email\n                },\n                data: {\n                  password: password,\n                  resetToken: null,\n                  resetTokenExpiry: null\n                }\n              });\n\n            case 14:\n              updatedUser = _context7.sent;\n              // Generate JWT\n              token = jsonwebtoken__WEBPACK_IMPORTED_MODULE_7___default.a.sign({\n                userId: updatedUser.id\n              }, process.env.JWT_SECRET); // Set JWT cookie\n\n              ctx.res.cookie(\"token\", token, tokenSettings); // Return the new user\n\n              return _context7.abrupt(\"return\", updatedUser);\n\n            case 18:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }))();\n  },\n  changePassword: function changePassword(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee8() {\n      var _ctx$req, user, userId, password, updatedUser;\n\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _ctx$req = ctx.req, user = _ctx$req.user, userId = _ctx$req.userId;\n\n              if (userId) {\n                _context8.next = 3;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 3:\n              if (!(args.password !== args.confirmPassword)) {\n                _context8.next = 5;\n                break;\n              }\n\n              throw new Error(\"Passwords do not match\");\n\n            case 5:\n              _context8.next = 7;\n              return getHash(args.password);\n\n            case 7:\n              password = _context8.sent;\n              _context8.next = 10;\n              return ctx.db.mutation.updateUser({\n                where: {\n                  email: user.email\n                },\n                data: {\n                  password: password\n                }\n              });\n\n            case 10:\n              updatedUser = _context8.sent;\n              return _context8.abrupt(\"return\", {\n                message: \"Your password has been changed\"\n              });\n\n            case 12:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }))();\n  },\n  changeEmail: function changeEmail(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee9() {\n      var userId, email;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              userId = ctx.req.userId;\n              email = args.email.toLowerCase();\n\n              if (userId) {\n                _context9.next = 4;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 4:\n              _context9.next = 6;\n              return ctx.db.mutation.updateUser({\n                where: {\n                  id: userId\n                },\n                data: {\n                  email: email\n                }\n              });\n\n            case 6:\n              return _context9.abrupt(\"return\", {\n                message: \"Your email has been changed\"\n              });\n\n            case 7:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9);\n    }))();\n  },\n  updateRole: function updateRole(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee10() {\n      var currentUser;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context10.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              _context10.next = 4;\n              return ctx.db.query.user({\n                where: {\n                  id: ctx.req.userId\n                }\n              }, info);\n\n            case 4:\n              currentUser = _context10.sent;\n              // Have proper roles to do this?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(currentUser, [\"ADMIN\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]); // Update role\n\n              _context10.prev = 7;\n              return _context10.abrupt(\"return\", ctx.db.mutation.updateUser({\n                data: {\n                  role: args.role,\n                  membershipLog: {\n                    create: [{\n                      time: new Date(),\n                      message: \"Role changed to \\\"\".concat(args.role, \"\\\" by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                      messageCode: \"ACCOUNT_CHANGED\",\n                      logger: {\n                        connect: {\n                          id: ctx.req.userId\n                        }\n                      }\n                    }]\n                  }\n                },\n                where: {\n                  id: args.userId\n                }\n              }, info));\n\n            case 11:\n              _context10.prev = 11;\n              _context10.t0 = _context10[\"catch\"](7);\n              throw new Error(\"\");\n\n            case 14:\n            case \"end\":\n              return _context10.stop();\n          }\n        }\n      }, _callee10, null, [[7, 11]]);\n    }))();\n  },\n  updateAccountType: function updateAccountType(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee11() {\n      var logs;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context11.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              // Have proper roles to do this?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(ctx.req.user, [\"ADMIN\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]); // Changing account type to 'FULL', add membership log\n\n              logs = [{\n                time: new Date(),\n                message: \"Account type changed to \\\"\".concat(args.accountType, \"\\\" by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                messageCode: \"ACCOUNT_CHANGED\",\n                logger: {\n                  connect: {\n                    id: ctx.req.userId\n                  }\n                }\n              }]; // Update account type\n\n              return _context11.abrupt(\"return\", ctx.db.mutation.updateUser({\n                data: {\n                  accountType: args.accountType,\n                  membershipLog: {\n                    create: logs\n                  }\n                },\n                where: {\n                  id: args.userId\n                }\n              }, info));\n\n            case 6:\n            case \"end\":\n              return _context11.stop();\n          }\n        }\n      }, _callee11);\n    }))();\n  },\n  updateAccountStatus: function updateAccountStatus(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee12() {\n      var currentUser, logs;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee12$(_context12) {\n        while (1) {\n          switch (_context12.prev = _context12.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context12.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              // Have proper roles to do this?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(ctx.req.user, [\"ADMIN\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]); // Query the current user\n\n              _context12.next = 6;\n              return ctx.db.query.user({\n                where: {\n                  id: args.userId\n                }\n              }, \"{ accountStatus }\");\n\n            case 6:\n              currentUser = _context12.sent;\n              // Add membership log\n              logs = [{\n                time: new Date(),\n                message: \"Account status changed to \\\"\".concat(args.accountStatus, \"\\\" by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                messageCode: \"ACCOUNT_CHANGED\",\n                logger: {\n                  connect: {\n                    id: ctx.req.userId\n                  }\n                }\n              }]; // Account unlocked\n\n              if (currentUser.accountStatus === \"LOCKED\" && args.data.accountStatus !== \"LOCKED\") {\n                logs.push({\n                  time: new Date(),\n                  message: \"Account unlocked by \".concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                  messageCode: \"ACCOUNT_UNLOCKED\",\n                  logger: {\n                    connect: {\n                      id: ctx.req.userId\n                    }\n                  }\n                });\n              } // Update status\n\n\n              return _context12.abrupt(\"return\", ctx.db.mutation.updateUser({\n                data: {\n                  accountStatus: args.accountStatus,\n                  membershipLog: {\n                    create: logs\n                  }\n                },\n                where: {\n                  id: args.userId\n                }\n              }, info));\n\n            case 10:\n            case \"end\":\n              return _context12.stop();\n          }\n        }\n      }, _callee12);\n    }))();\n  },\n  updateOffice: function updateOffice(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee13() {\n      var _yield$ctx$db$query$u3, existingOffice, defaultLog, logs, messageLogs;\n\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee13$(_context13) {\n        while (1) {\n          switch (_context13.prev = _context13.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context13.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              // Have proper account status to do this?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(ctx.req.user, [\"ADMIN\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              _context13.next = 6;\n              return ctx.db.query.user({\n                where: {\n                  id: args.userId\n                }\n              }, \"{ office }\");\n\n            case 6:\n              _yield$ctx$db$query$u3 = _context13.sent;\n              existingOffice = _yield$ctx$db$query$u3.office;\n\n              if (!(existingOffice === args.office)) {\n                _context13.next = 10;\n                break;\n              }\n\n              throw new Error(\"Cannot change office to the same office\");\n\n            case 10:\n              defaultLog = {\n                time: new Date(),\n                logger: {\n                  connect: {\n                    id: ctx.req.userId\n                  }\n                }\n              };\n              logs = []; // Add new value\n\n              if (existingOffice === null && typeof args.office === \"string\") {\n                logs.push({\n                  message: \"\\\"\".concat(args.office, \"\\\" office added by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                  messageCode: \"OFFICE_ADDED\"\n                });\n              } // Removing old value\n              else if (typeof existingOffice === \"string\" && args.office === null) {\n                  logs.push({\n                    message: \"\\\"\".concat(existingOffice, \"\\\" office removed by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                    messageCode: \"OFFICE_REMOVED\"\n                  });\n                } // Replacing old value\n                else if (existingOffice !== args.office) {\n                    logs.push({\n                      message: \"\\\"\".concat(existingOffice, \"\\\" office removed by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                      messageCode: \"OFFICE_REMOVED\"\n                    }, {\n                      message: \"\\\"\".concat(args.office, \"\\\" office added by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                      messageCode: \"OFFICE_ADDED\"\n                    });\n                  }\n\n              messageLogs = logs.map(function (log) {\n                return _objectSpread(_objectSpread({}, log), defaultLog);\n              }); // Update office\n\n              return _context13.abrupt(\"return\", ctx.db.mutation.updateUser({\n                data: {\n                  office: args.office === \"NONE\" ? null : args.office,\n                  membershipLog: {\n                    create: messageLogs\n                  }\n                },\n                where: {\n                  id: args.userId\n                }\n              }, info));\n\n            case 15:\n            case \"end\":\n              return _context13.stop();\n          }\n        }\n      }, _callee13);\n    }))();\n  },\n  updateTitle: function updateTitle(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee14() {\n      var _yield$ctx$db$query$u4, existingTitle, defaultLog, logs, messageLogs;\n\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee14$(_context14) {\n        while (1) {\n          switch (_context14.prev = _context14.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context14.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              // Have proper roles to do this?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(ctx.req.user, [\"ADMIN\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              _context14.next = 6;\n              return ctx.db.query.user({\n                where: {\n                  id: args.userId\n                }\n              }, \"{ title }\");\n\n            case 6:\n              _yield$ctx$db$query$u4 = _context14.sent;\n              existingTitle = _yield$ctx$db$query$u4.title;\n\n              if (!(existingTitle === args.title)) {\n                _context14.next = 10;\n                break;\n              }\n\n              throw new Error(\"Cannot change title to the same title\");\n\n            case 10:\n              defaultLog = {\n                time: new Date(),\n                logger: {\n                  connect: {\n                    id: ctx.req.userId\n                  }\n                }\n              };\n              logs = []; // Add new value\n\n              if (existingTitle === null && typeof args.title === \"string\") {\n                logs.push({\n                  message: \"\\\"\".concat(args.title, \"\\\" title added by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                  messageCode: \"TITLE_ADDED\"\n                });\n              } // Removing old value\n              else if (typeof existingTitle === \"string\" && args.title === null) {\n                  logs.push({\n                    message: \"\\\"\".concat(existingTitle, \"\\\" title removed by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                    messageCode: \"TITLE_REMOVED\"\n                  });\n                } // Replacing old value\n                else if (existingTitle !== args.title) {\n                    logs.push({\n                      message: \"\\\"\".concat(existingTitle, \"\\\" title removed by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                      messageCode: \"TITLE_REMOVED\"\n                    }, {\n                      message: \"\\\"\".concat(args.title, \"\\\" title added by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                      messageCode: \"TITLE_ADDED\"\n                    });\n                  }\n\n              messageLogs = logs.map(function (log) {\n                return _objectSpread(_objectSpread(_objectSpread({}, log), defaultLog), {}, {\n                  time: new Date()\n                });\n              }); // Update title\n\n              return _context14.abrupt(\"return\", ctx.db.mutation.updateUser({\n                data: {\n                  title: args.title,\n                  membershipLog: {\n                    create: messageLogs\n                  }\n                },\n                where: {\n                  id: args.userId\n                }\n              }, info));\n\n            case 15:\n            case \"end\":\n              return _context14.stop();\n          }\n        }\n      }, _callee14);\n    }))();\n  },\n  createEvent: function createEvent(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee15() {\n      var event, attendees, data, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee15$(_context15) {\n        while (1) {\n          switch (_context15.prev = _context15.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context15.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              // Have proper roles to do this?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              event = args.event;\n              attendees = [{\n                member: {\n                  connect: {\n                    username: event.host\n                  }\n                },\n                status: \"GOING\"\n              }];\n              data = {\n                type: event.type,\n                title: event.title,\n                description: event.description || \"\",\n                startTime: new Date(event.startTime),\n                endTime: new Date(event.endTime),\n                address: event.address || \"\",\n                trailDifficulty: event.trailDifficulty || \"\",\n                // trailNotes: event.trailNotes,\n                rallyAddress: event.rallyAddress || \"\",\n                rallyTime: event.rallyTime || \"\",\n                membersOnly: false,\n                // TODO\n                creator: {\n                  connect: {\n                    id: ctx.req.userId\n                  }\n                },\n                host: {\n                  connect: {\n                    username: event.host\n                  }\n                },\n                rsvps: {\n                  create: attendees\n                }\n              };\n\n              if (event.trail !== \"0\") {\n                data.trail = {\n                  connect: {\n                    id: event.trail\n                  }\n                };\n              }\n\n              _context15.next = 10;\n              return ctx.db.mutation.createEvent({\n                data: data\n              }, info);\n\n            case 10:\n              results = _context15.sent;\n              return _context15.abrupt(\"return\", {\n                message: \"Your event has been created\"\n              });\n\n            case 12:\n            case \"end\":\n              return _context15.stop();\n          }\n        }\n      }, _callee15);\n    }))();\n  },\n  updateEvent: function updateEvent(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee16() {\n      var event, eventId, existingEvent, data, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee16$(_context16) {\n        while (1) {\n          switch (_context16.prev = _context16.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context16.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              // Have proper roles to do this?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              event = args.event, eventId = args.id; // Get current event for later comparison\n\n              _context16.next = 7;\n              return ctx.db.query.event({\n                where: {\n                  id: eventId\n                }\n              }, info);\n\n            case 7:\n              existingEvent = _context16.sent;\n              data = {\n                title: event.title,\n                description: event.description || \"\",\n                startTime: new Date(event.startTime),\n                endTime: new Date(event.endTime),\n                address: event.address || \"\",\n                trailDifficulty: event.trailDifficulty || \"\",\n                // trailNotes: event.trailNotes,\n                rallyAddress: event.rallyAddress || \"\",\n                rallyTime: event.rallyTime || \"\",\n                membersOnly: false,\n                // TODO\n                creator: {\n                  connect: {\n                    id: ctx.req.userId\n                  }\n                },\n                host: {\n                  connect: {\n                    username: event.host\n                  }\n                }\n              };\n\n              if (event.trail && event.trail !== \"0\") {\n                // New trail submitted\n                data.trail = {\n                  connect: {\n                    id: event.trail\n                  }\n                };\n              } else if (existingEvent.trail && existingEvent.trail.id && !event.trail) {\n                // Remove old trail\n                data.trail = {\n                  disconnect: true\n                };\n              }\n\n              if (event.newFeaturedImage) {\n                // New featured image submitted\n                data.featuredImage = {\n                  upsert: {\n                    create: _objectSpread({}, event.newFeaturedImage),\n                    update: _objectSpread({}, event.newFeaturedImage)\n                  }\n                };\n              } else if (existingEvent.featuredImage && existingEvent.featuredImage.publicId && !event.newFeaturedImage) {\n                // Remove old featured image\n                data.featuredImage = {\n                  \"delete\": true\n                };\n              }\n\n              _context16.next = 13;\n              return ctx.db.mutation.updateEvent({\n                data: data,\n                where: {\n                  id: eventId\n                }\n              }, info);\n\n            case 13:\n              results = _context16.sent;\n              return _context16.abrupt(\"return\", {\n                message: \"Your event has been updated\"\n              });\n\n            case 15:\n            case \"end\":\n              return _context16.stop();\n          }\n        }\n      }, _callee16);\n    }))();\n  },\n  setRSVP: function setRSVP(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee17() {\n      var rsvp, currentUser, userRSVP;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee17$(_context17) {\n        while (1) {\n          switch (_context17.prev = _context17.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context17.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              rsvp = args.rsvp; // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]); // Requesting user has proper role?\n\n              if (ctx.req.userId !== rsvp.userId) {\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\"]);\n              } // Query the current user\n\n\n              _context17.next = 7;\n              return ctx.db.query.user({\n                where: {\n                  id: rsvp.userId\n                }\n              }, \"{ id, eventsRSVPd { id, status, event { id } } }\");\n\n            case 7:\n              currentUser = _context17.sent;\n\n              if (currentUser) {\n                _context17.next = 10;\n                break;\n              }\n\n              throw new Error(\"User does not have permission\");\n\n            case 10:\n              // Has this user already RSVPd?\n              userRSVP = currentUser.eventsRSVPd.find(function (eventRSVP) {\n                return eventRSVP.event.id === rsvp.eventId;\n              }); // If this RSVP is not different, return gracefully\n\n              if (!(userRSVP && userRSVP.status === rsvp.status)) {\n                _context17.next = 13;\n                break;\n              }\n\n              return _context17.abrupt(\"return\", {\n                message: \"Already RSVPd, no change recorded\"\n              });\n\n            case 13:\n              if (!(userRSVP && userRSVP.status !== rsvp.status)) {\n                _context17.next = 17;\n                break;\n              }\n\n              _context17.next = 16;\n              return ctx.db.mutation.updateRSVP({\n                where: {\n                  id: userRSVP.id\n                },\n                data: {\n                  status: rsvp.status\n                }\n              }, info);\n\n            case 16:\n              return _context17.abrupt(\"return\", {\n                message: \"Thank you for updating your RSVP\"\n              });\n\n            case 17:\n              _context17.next = 19;\n              return ctx.db.mutation.createRSVP({\n                data: {\n                  status: rsvp.status,\n                  member: {\n                    connect: {\n                      id: rsvp.userId\n                    }\n                  },\n                  event: {\n                    connect: {\n                      id: rsvp.eventId\n                    }\n                  }\n                }\n              }, info);\n\n            case 19:\n              return _context17.abrupt(\"return\", {\n                message: \"Thank you for RSVPing\"\n              });\n\n            case 20:\n            case \"end\":\n              return _context17.stop();\n          }\n        }\n      }, _callee17);\n    }))();\n  },\n  sendMessage: function sendMessage(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee18() {\n      var user, to, subject, htmlText, emailSettings, email, peopleQueries, groupQueries, query, emails;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee18$(_context18) {\n        while (1) {\n          switch (_context18.prev = _context18.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context18.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              // Requesting user has proper account status?\n              user = ctx.req.user;\n              to = args.to, subject = args.subject, htmlText = args.htmlText;\n\n              if (!(to.length === 0)) {\n                _context18.next = 6;\n                break;\n              }\n\n              throw new Error(\"No recipients found\");\n\n            case 6:\n              // Can email ALL users\n              if (to.includes(\"all_users\")) {\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(user, [\"ADMIN\"]);\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(user, [\"ACTIVE\"]);\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountType\"])(user, [\"FULL\"]);\n              } // Can email guests or full members\n\n\n              if (to.includes(\"guests\") || to.includes(\"all_active\") || to.includes(\"full_membership\")) {\n                // Is active full member and at least an officer\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(user, [\"ADMIN\", \"OFFICER\"]);\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(user, [\"ACTIVE\"]);\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountType\"])(user, [\"FULL\"]);\n              } // Can email run leaders\n\n\n              if (to.includes(\"run_leaders\")) {\n                // Is active full member and at least the Run Master\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(user, [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\"]);\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(user, [\"ACTIVE\"]);\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountType\"])(user, [\"FULL\"]);\n              } // Can email multiple individual members\n\n\n              if ((!to.includes(\"officers\") || !to.includes(\"webmaster\")) && !to.some(function (subject) {\n                return subject === _config__WEBPACK_IMPORTED_MODULE_14__[\"emailGroups\"];\n              }) && to.length > 1) {\n                // Is active full or emeritus and at least a run leader\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(user, _config__WEBPACK_IMPORTED_MODULE_14__[\"roles\"].filter(function (role) {\n                  return role !== \"USER\";\n                }));\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(user, [\"ACTIVE\"]);\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountType\"])(user, [\"FULL\", \"EMERITUS\"]);\n              } // Can email individual members\n\n\n              if ((!to.includes(\"officers\") || !to.includes(\"webmaster\")) && !to.some(function (subject) {\n                return subject === _config__WEBPACK_IMPORTED_MODULE_14__[\"emailGroups\"];\n              })) {\n                // Is active full or emeritus\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(user, [\"ACTIVE\"]);\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountType\"])(user, [\"FULL\", \"EMERITUS\", \"ASSOCIATE\"]);\n              } // Can email Run Master\n\n\n              if (to.includes(\"runmaster\")) {\n                // Is active member\n                Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(user, [\"ACTIVE\"]);\n              } // Anyone logged in can email the officers or the webmaster\n\n\n              emailSettings = {\n                from: user.email,\n                subject: \"[4-Players] \".concat(subject || \"Message from \".concat(user.firstName)),\n                // text,\n                html: htmlText\n              };\n\n              if (!(to.length === 1 && !_config__WEBPACK_IMPORTED_MODULE_14__[\"emailGroups\"].some(function (recipient) {\n                return recipient === to[0];\n              }))) {\n                _context18.next = 20;\n                break;\n              }\n\n              _context18.next = 16;\n              return ctx.db.query.user({\n                where: {\n                  username: to[0]\n                }\n              }, \"{ email }\");\n\n            case 16:\n              email = _context18.sent;\n              emailSettings.to = [email];\n              _context18.next = 28;\n              break;\n\n            case 20:\n              // Send email to many people\n              // To do: email permissions\n              peopleQueries = to.filter(function (recipient) {\n                return !_config__WEBPACK_IMPORTED_MODULE_14__[\"emailGroups\"].includes(recipient);\n              }).map(function (person) {\n                return {\n                  username: person\n                };\n              });\n              groupQueries = to.filter(function (recipient) {\n                return _config__WEBPACK_IMPORTED_MODULE_14__[\"emailGroups\"].includes(recipient);\n              }).map(function (group) {\n                switch (group) {\n                  case \"officers\":\n                    return {\n                      NOT: {\n                        office: null\n                      }\n                    };\n\n                  case \"runmaster\":\n                    return {\n                      role: \"RUN_MASTER\"\n                    };\n\n                  case \"webmaster\":\n                    return {\n                      title: \"WEBMASTER\"\n                    };\n\n                  case \"run_leaders\":\n                    return {\n                      role: \"RUN_LEADER\"\n                    };\n\n                  case \"full_membership\":\n                    return {\n                      AND: [{\n                        OR: [{\n                          accountType: \"FULL\"\n                        }, {\n                          accountType: \"EMITERUS\"\n                        }, {\n                          accountType: \"ASSOCIATE\"\n                        }]\n                      }, {\n                        accountStatus: \"ACTIVE\"\n                      }]\n                    };\n\n                  case \"all_active\":\n                    return {\n                      accountStatus: \"ACTIVE\"\n                    };\n\n                  case \"all_users\":\n                    return {\n                      NOT: {\n                        email: null\n                      }\n                    };\n\n                  default:\n                    // guests\n                    return {\n                      AND: [{\n                        accountType: \"GUEST\"\n                      }, {\n                        accountStatus: \"ACTIVE\"\n                      }]\n                    };\n                }\n              }); // To do: handle duplicates, if any\n\n              query = {\n                where: {\n                  OR: peopleQueries\n                }\n              };\n\n              if (groupQueries.length) {\n                query = {\n                  where: {\n                    OR: [].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(query.where[\"OR\"]), _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(groupQueries))\n                  }\n                };\n              }\n\n              _context18.next = 26;\n              return ctx.db.query.users(query, \"{ email }\");\n\n            case 26:\n              emails = _context18.sent;\n\n              if (emails && emails.length > 1) {\n                emailSettings.to = \"info@4-playersofcolorado.org\";\n                emailSettings.bcc = emails.map(function (email) {\n                  return email.email;\n                });\n              } else {\n                emailSettings.to = user.email;\n              }\n\n            case 28:\n              if (!(emailSettings.to.length >= 1)) {\n                _context18.next = 30;\n                break;\n              }\n\n              return _context18.abrupt(\"return\", Object(_mail__WEBPACK_IMPORTED_MODULE_12__[\"sendTransactionalEmail\"])(emailSettings).then(function () {\n                return {\n                  message: \"Message has been sent\"\n                };\n              })[\"catch\"](function (err) {\n                throw new Error(err.toString());\n              }));\n\n            case 30:\n              throw new Error(\"No email addresses found for recipient(s)\");\n\n            case 31:\n            case \"end\":\n              return _context18.stop();\n          }\n        }\n      }, _callee18);\n    }))();\n  },\n  updateUserProfileSettings: function updateUserProfileSettings(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee19() {\n      var currentUser, logs, obj, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee19$(_context19) {\n        while (1) {\n          switch (_context19.prev = _context19.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context19.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              if (!(Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\"], false) || Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"isSelf\"])(ctx.req.user, args.id, false))) {\n                _context19.next = 18;\n                break;\n              }\n\n              _context19.next = 5;\n              return ctx.db.query.user({\n                where: {\n                  id: args.id\n                }\n              }, \"{ accountType, accountStatus, role, joined }\");\n\n            case 5:\n              currentUser = _context19.sent;\n              logs = []; // Became a full member\n\n              if (currentUser.accountType === \"FULL\" && typeof args.data.joined === \"string\" && currentUser.joined === null) {\n                logs.push({\n                  time: new Date(),\n                  message: \"Became a Full Member\",\n                  messageCode: \"MEMBERSHIP_GRANTED\",\n                  logger: {\n                    connect: {\n                      id: ctx.req.userId\n                    }\n                  }\n                });\n              } // Account unlocked\n\n\n              if (currentUser.accountStatus === \"LOCKED\" && args.data.accountStatus !== \"LOCKED\") {\n                logs.push({\n                  time: new Date(),\n                  message: \"Account unlocked by \".concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                  messageCode: \"ACCOUNT_UNLOCKED\",\n                  logger: {\n                    connect: {\n                      id: ctx.req.userId\n                    }\n                  }\n                });\n              } // Account rejected\n              // TODO\n              // Update user\n\n\n              obj = {\n                data: {\n                  firstName: args.data.firstName,\n                  lastName: args.data.lastName,\n                  username: args.data.username,\n                  gender: args.data.gender,\n                  birthdate: new Date(args.data.birthdate),\n                  joined: args.data.joined ? new Date(args.data.joined) : null,\n                  contactInfo: {\n                    upsert: {\n                      create: {\n                        street: args.data.street,\n                        city: args.data.city,\n                        state: args.data.state,\n                        zip: args.data.zip,\n                        phone: args.data.phone\n                      },\n                      update: {\n                        street: args.data.street,\n                        city: args.data.city,\n                        state: args.data.state,\n                        zip: args.data.zip,\n                        phone: args.data.phone\n                      }\n                    }\n                  },\n                  preferences: {\n                    upsert: {\n                      create: {\n                        emergencyContactName: args.data.emergencyContactName,\n                        emergencyContactPhone: args.data.emergencyContactPhone,\n                        showPhoneNumber: args.data.showPhoneNumber\n                      },\n                      update: {\n                        emergencyContactName: args.data.emergencyContactName,\n                        emergencyContactPhone: args.data.emergencyContactPhone,\n                        showPhoneNumber: args.data.showPhoneNumber\n                      }\n                    }\n                  },\n                  membershipLog: {\n                    create: logs\n                  }\n                },\n                where: {\n                  id: args.id\n                }\n              };\n              _context19.next = 12;\n              return ctx.db.mutation.updateUser(obj, info);\n\n            case 12:\n              results = _context19.sent;\n\n              if (true) {\n                _context19.next = 15;\n                break;\n              }\n\n              return _context19.abrupt(\"return\", {\n                message: \"Unable to update user profile settings\"\n              });\n\n            case 15:\n              return _context19.abrupt(\"return\", {\n                message: \"User profile settings updated\"\n              });\n\n            case 18:\n              throw new Error(\"User profile can only be updated by the user, an admin, or an officer\");\n\n            case 19:\n            case \"end\":\n              return _context19.stop();\n          }\n        }\n      }, _callee19);\n    }))();\n  },\n  updateUserAdminProfileSettings: function updateUserAdminProfileSettings(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee20() {\n      var data, currentUser, defaultLog, logs, messageLogs;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee20$(_context20) {\n        while (1) {\n          switch (_context20.prev = _context20.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context20.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              if (Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\"], false)) {\n                _context20.next = 4;\n                break;\n              }\n\n              throw new Error(\"User profile can only be updated by an admin or an officer\");\n\n            case 4:\n              // Requesting user has proper account status?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              data = args.data; // Query the current user\n\n              _context20.next = 8;\n              return ctx.db.query.user({\n                where: {\n                  id: args.id\n                }\n              }, \"{ id, accountType, accountStatus, role, office, title }\");\n\n            case 8:\n              currentUser = _context20.sent;\n              // Logs\n              defaultLog = {\n                time: new Date(),\n                logger: {\n                  connect: {\n                    id: ctx.req.userId\n                  }\n                }\n              };\n              logs = []; // Add new title\n\n              if (currentUser.title === null && typeof data.title === \"string\") {\n                logs.push({\n                  message: \"\\\"\".concat(data.title, \"\\\" title added by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                  messageCode: \"TITLE_ADDED\"\n                });\n              } // Removing old title\n              else if (typeof currentUser.title === \"string\" && data.title === null) {\n                  logs.push({\n                    message: \"\\\"\".concat(currentUser.title, \"\\\" title removed by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                    messageCode: \"TITLE_REMOVED\"\n                  });\n                } // Replace title\n                else if (typeof currentUser.title === \"string\" && typeof data.title === \"string\" && currentUser.title !== data.title) {\n                    logs.push({\n                      message: \"\\\"\".concat(currentUser.title, \"\\\" title removed by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                      messageCode: \"TITLE_REMOVED\"\n                    }, {\n                      message: \"\\\"\".concat(data.title, \"\\\" title added by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                      messageCode: \"TITLE_ADDED\"\n                    });\n                  } // Add new office\n\n\n              if (currentUser.office === null && typeof data.office === \"string\") {\n                logs.push({\n                  message: \"\\\"\".concat(data.office, \"\\\" office added by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                  messageCode: \"OFFICE_ADDED\"\n                });\n              } // Removing old office\n              else if (typeof currentUser.office === \"string\" && data.office === null) {\n                  logs.push({\n                    message: \"\\\"\".concat(currentUser.office, \"\\\" office removed by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                    messageCode: \"OFFICE_REMOVED\"\n                  });\n                } // Replace office\n                else if (typeof currentUser.office === \"string\" && typeof data.office === \"string\" && currentUser.office !== data.office) {\n                    logs.push({\n                      message: \"\\\"\".concat(currentUser.office, \"\\\" office removed by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                      messageCode: \"OFFICE_REMOVED\"\n                    }, {\n                      message: \"\\\"\".concat(data.office, \"\\\" office added by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                      messageCode: \"OFFICE_ADDED\"\n                    });\n                  }\n\n              if (currentUser.role !== data.role) {\n                logs.push({\n                  message: \"Role changed to \\\"\".concat(data.role, \"\\\" by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                  messageCode: \"ACCOUNT_CHANGED\"\n                });\n              }\n\n              if (currentUser.accountStatus !== data.accountStatus) {\n                logs.push({\n                  message: \"Account status changed to \\\"\".concat(data.accountStatus, \"\\\" by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                  messageCode: \"ACCOUNT_CHANGED\"\n                });\n              }\n\n              if (currentUser.accountType !== data.accountType) {\n                logs.push({\n                  message: \"Account type changed to \\\"\".concat(data.accountType, \"\\\" by \").concat(ctx.req.user.firstName, \" \").concat(ctx.req.user.lastName),\n                  messageCode: \"ACCOUNT_CHANGED\"\n                });\n              }\n\n              messageLogs = logs.map(function (log) {\n                return _objectSpread(_objectSpread({}, log), defaultLog);\n              }); // Update user\n\n              _context20.next = 19;\n              return ctx.db.mutation.updateUser({\n                data: _objectSpread(_objectSpread({}, data), messageLogs.length > 0 ? {\n                  membershipLog: {\n                    create: messageLogs\n                  }\n                } : {}),\n                where: {\n                  id: args.id\n                }\n              }, info);\n\n            case 19:\n              if (true) {\n                _context20.next = 21;\n                break;\n              }\n\n              return _context20.abrupt(\"return\", {\n                message: \"Unable to update user profile settings\"\n              });\n\n            case 21:\n              return _context20.abrupt(\"return\", {\n                message: \"User profile settings updated\"\n              });\n\n            case 22:\n            case \"end\":\n              return _context20.stop();\n          }\n        }\n      }, _callee20);\n    }))();\n  },\n  updateAvatar: function updateAvatar(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee21() {\n      var data, oldAvatar, newAvatar, formData, obj, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee21$(_context21) {\n        while (1) {\n          switch (_context21.prev = _context21.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context21.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              data = args.data;\n              oldAvatar = data.old, newAvatar = data[\"new\"];\n\n              if (!oldAvatar) {\n                _context21.next = 15;\n                break;\n              }\n\n              // Delete old image via Cloudinary API\n              formData = {\n                api_key: process.env.CLOUDINARY_KEY,\n                public_id: oldAvatar.publicId\n              };\n              _context21.prev = 6;\n              _context21.next = 9;\n              return node_fetch__WEBPACK_IMPORTED_MODULE_10___default()(\"https://api.cloudinary.com/v1_1/fourplayers/image/destroy\", {\n                method: \"POST\",\n                body: formData\n              });\n\n            case 9:\n              _context21.next = 15;\n              break;\n\n            case 11:\n              _context21.prev = 11;\n              _context21.t0 = _context21[\"catch\"](6);\n              console.error(_context21.t0);\n              throw new Error(\"Unable to remove old avatar\");\n\n            case 15:\n              // Update user\n              obj = {\n                data: {\n                  avatar: {\n                    upsert: {\n                      create: {\n                        publicId: newAvatar.publicId,\n                        url: newAvatar.url,\n                        smallUrl: newAvatar.smallUrl\n                      },\n                      update: {\n                        publicId: newAvatar.publicId,\n                        url: newAvatar.url,\n                        smallUrl: newAvatar.smallUrl\n                      }\n                    }\n                  }\n                },\n                where: {\n                  id: ctx.req.userId\n                }\n              };\n              _context21.next = 18;\n              return ctx.db.mutation.updateUser(obj, info);\n\n            case 18:\n              results = _context21.sent;\n              _context21.next = 21;\n              return ctx.db.mutation.createActivityLogItem({\n                data: {\n                  time: new Date(),\n                  message: \"Added a new profile photo\",\n                  messageCode: \"PROFILE_PHOTO_SUBMITTED\",\n                  link: \"/profile/\".concat(ctx.req.user.username),\n                  user: {\n                    connect: {\n                      id: ctx.req.userId\n                    }\n                  }\n                }\n              });\n\n            case 21:\n              if (true) {\n                _context21.next = 23;\n                break;\n              }\n\n              return _context21.abrupt(\"return\", {\n                message: \"Unable to update avatar\"\n              });\n\n            case 23:\n              return _context21.abrupt(\"return\", {\n                message: \"Avatar updated\"\n              });\n\n            case 24:\n            case \"end\":\n              return _context21.stop();\n          }\n        }\n      }, _callee21, null, [[6, 11]]);\n    }))();\n  },\n  deleteAvatar: function deleteAvatar(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee22() {\n      var avatar, cloudinaryResults, obj, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee22$(_context22) {\n        while (1) {\n          switch (_context22.prev = _context22.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context22.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              avatar = args.avatar; // Remove from Cloudinary\n\n              _context22.prev = 3;\n              _context22.next = 6;\n              return promisifiedDestroy(avatar.publicId);\n\n            case 6:\n              cloudinaryResults = _context22.sent;\n\n              if (!(cloudinaryResults && cloudinaryResults.result !== \"ok\")) {\n                _context22.next = 9;\n                break;\n              }\n\n              throw new Error(cloudinaryResults);\n\n            case 9:\n              _context22.next = 15;\n              break;\n\n            case 11:\n              _context22.prev = 11;\n              _context22.t0 = _context22[\"catch\"](3);\n              console.error(_context22.t0);\n              throw new Error(\"Unable to delete old avatar\");\n\n            case 15:\n              // Remove from user\n              obj = {\n                data: {\n                  avatar: {\n                    \"delete\": true\n                  }\n                },\n                where: {\n                  id: ctx.req.userId\n                }\n              };\n              _context22.next = 18;\n              return ctx.db.mutation.updateUser(obj, info);\n\n            case 18:\n              results = _context22.sent;\n\n              if (true) {\n                _context22.next = 21;\n                break;\n              }\n\n              return _context22.abrupt(\"return\", {\n                message: \"Unable to delete avatar\"\n              });\n\n            case 21:\n              return _context22.abrupt(\"return\", {\n                message: \"Avatar deleted\"\n              });\n\n            case 22:\n            case \"end\":\n              return _context22.stop();\n          }\n        }\n      }, _callee22, null, [[3, 11]]);\n    }))();\n  },\n  updateRig: function updateRig(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee23() {\n      var data, old, newRig, cloudinaryResults, obj, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee23$(_context23) {\n        while (1) {\n          switch (_context23.prev = _context23.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context23.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              data = args.data;\n              old = data.old, newRig = data[\"new\"]; // Remove from Cloudinary\n\n              if (!old) {\n                _context23.next = 17;\n                break;\n              }\n\n              _context23.prev = 5;\n              _context23.next = 8;\n              return promisifiedDestroy(old.publicId);\n\n            case 8:\n              cloudinaryResults = _context23.sent;\n\n              if (!(cloudinaryResults.result !== \"ok\")) {\n                _context23.next = 11;\n                break;\n              }\n\n              throw new Error(\"Unable to delete old rig image\", cloudinaryResults);\n\n            case 11:\n              _context23.next = 17;\n              break;\n\n            case 13:\n              _context23.prev = 13;\n              _context23.t0 = _context23[\"catch\"](5);\n              console.error(_context23.t0);\n              throw new Error(\"Unable to delete old rig image\");\n\n            case 17:\n              // Update user\n              obj = {\n                data: {\n                  rig: {\n                    upsert: {\n                      create: {\n                        image: {\n                          create: {\n                            publicId: newRig.publicId,\n                            url: newRig.url,\n                            smallUrl: newRig.smallUrl\n                          }\n                        }\n                      },\n                      update: {\n                        image: {\n                          upsert: {\n                            create: {\n                              publicId: newRig.publicId,\n                              url: newRig.url,\n                              smallUrl: newRig.smallUrl\n                            },\n                            update: {\n                              publicId: newRig.publicId,\n                              url: newRig.url,\n                              smallUrl: newRig.smallUrl\n                            }\n                          }\n                        }\n                      }\n                    }\n                  }\n                },\n                where: {\n                  id: ctx.req.userId\n                }\n              };\n              _context23.next = 20;\n              return ctx.db.mutation.updateUser(obj, info);\n\n            case 20:\n              results = _context23.sent;\n              _context23.next = 23;\n              return ctx.db.mutation.createActivityLogItem({\n                data: {\n                  time: new Date(),\n                  message: \"Added a new rigbook photo\",\n                  messageCode: \"RIGBOOK_PHOTO_SUBMITTED\",\n                  link: \"/profile/\".concat(ctx.req.user.username),\n                  user: {\n                    connect: {\n                      id: ctx.req.userId\n                    }\n                  }\n                }\n              });\n\n            case 23:\n              if (true) {\n                _context23.next = 25;\n                break;\n              }\n\n              return _context23.abrupt(\"return\", {\n                message: \"Unable to update rig image\"\n              });\n\n            case 25:\n              return _context23.abrupt(\"return\", {\n                message: \"Rig image updated\"\n              });\n\n            case 26:\n            case \"end\":\n              return _context23.stop();\n          }\n        }\n      }, _callee23, null, [[5, 13]]);\n    }))();\n  },\n  deleteRig: function deleteRig(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee24() {\n      var rig, cloudinaryResults, obj, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee24$(_context24) {\n        while (1) {\n          switch (_context24.prev = _context24.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context24.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              rig = args.rig; // Remove from Cloudinary\n\n              _context24.prev = 3;\n              _context24.next = 6;\n              return promisifiedDestroy(rig.publicId);\n\n            case 6:\n              cloudinaryResults = _context24.sent;\n\n              if (!(cloudinaryResults && cloudinaryResults.result !== \"ok\")) {\n                _context24.next = 9;\n                break;\n              }\n\n              throw new Error(cloudinaryResults);\n\n            case 9:\n              _context24.next = 15;\n              break;\n\n            case 11:\n              _context24.prev = 11;\n              _context24.t0 = _context24[\"catch\"](3);\n              console.error(_context24.t0);\n              throw new Error(\"Unable to delete old rig image\");\n\n            case 15:\n              // Remove from user\n              obj = {\n                data: {\n                  rig: {\n                    \"delete\": true\n                  }\n                },\n                where: {\n                  id: ctx.req.userId\n                }\n              };\n              _context24.next = 18;\n              return ctx.db.mutation.updateUser(obj, info);\n\n            case 18:\n              results = _context24.sent;\n\n              if (true) {\n                _context24.next = 21;\n                break;\n              }\n\n              return _context24.abrupt(\"return\", {\n                message: \"Unable to update rig image\"\n              });\n\n            case 21:\n              return _context24.abrupt(\"return\", {\n                message: \"Rig image deleted\"\n              });\n\n            case 22:\n            case \"end\":\n              return _context24.stop();\n          }\n        }\n      }, _callee24, null, [[3, 11]]);\n    }))();\n  },\n  updateVehicle: function updateVehicle(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee25() {\n      var vehicle, vehicleId, outfitLevel, mods, restVehicle, data, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee25$(_context25) {\n        while (1) {\n          switch (_context25.prev = _context25.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context25.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              // Requesting user has proper account status?\n              // hasAccountStatus(ctx.req.user, [\"ACTIVE\"]);\n              vehicle = args.vehicle, vehicleId = args.id;\n              outfitLevel = vehicle.outfitLevel, mods = vehicle.mods, restVehicle = _babel_runtime_helpers_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_3___default()(vehicle, [\"outfitLevel\", \"mods\"]);\n              data = {\n                vehicle: {\n                  upsert: {\n                    create: _objectSpread({\n                      outfitLevel: outfitLevel && outfitLevel != 0 ? outfitLevel : null,\n                      mods: {\n                        set: mods || []\n                      }\n                    }, restVehicle),\n                    update: _objectSpread({\n                      outfitLevel: outfitLevel && outfitLevel != 0 ? outfitLevel : null,\n                      mods: {\n                        set: mods || []\n                      }\n                    }, restVehicle)\n                  }\n                }\n              };\n              _context25.next = 7;\n              return ctx.db.mutation.updateUser({\n                data: data,\n                where: {\n                  id: ctx.req.userId\n                }\n              }, info);\n\n            case 7:\n              results = _context25.sent;\n              return _context25.abrupt(\"return\", {\n                message: \"Your vehicle has been updated\"\n              });\n\n            case 9:\n            case \"end\":\n              return _context25.stop();\n          }\n        }\n      }, _callee25);\n    }))();\n  },\n  submitElection: function submitElection(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee26() {\n      var election, races;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee26$(_context26) {\n        while (1) {\n          switch (_context26.prev = _context26.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context26.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              // Have proper roles to do this?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              election = args.election; // Format races\n\n              races = election.races.map(function (race) {\n                race.candidates = {\n                  connect: race.candidates\n                };\n                return race;\n              }); // Update election\n\n              return _context26.abrupt(\"return\", ctx.db.mutation.createElection({\n                data: {\n                  electionName: election.electionName,\n                  startTime: election.startTime,\n                  endTime: election.endTime,\n                  // 1 week default\n                  races: {\n                    create: races\n                  }\n                }\n              }, info));\n\n            case 7:\n            case \"end\":\n              return _context26.stop();\n          }\n        }\n      }, _callee26);\n    }))();\n  },\n  submitVote: function submitVote(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee27() {\n      var vote, votes, data;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee27$(_context27) {\n        while (1) {\n          switch (_context27.prev = _context27.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context27.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              // Requesting user has proper account type?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountType\"])(ctx.req.user, [\"FULL\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]); // Have they voted for this ballot before?\n\n              vote = args.vote;\n              _context27.next = 7;\n              return ctx.db.query.votes({\n                where: {\n                  AND: [{\n                    ballot: {\n                      id: vote.ballot\n                    }\n                  }, {\n                    voter: {\n                      id: ctx.req.userId\n                    }\n                  }]\n                }\n              }, info);\n\n            case 7:\n              votes = _context27.sent;\n\n              if (!(votes.length > 0)) {\n                _context27.next = 10;\n                break;\n              }\n\n              throw new Error(\"User has voted already\");\n\n            case 10:\n              data = {\n                dateTime: new Date(vote.dateTime),\n                ballot: {\n                  connect: {\n                    id: vote.ballot\n                  }\n                },\n                voter: {\n                  connect: {\n                    id: ctx.req.userId\n                  }\n                }\n              };\n\n              if (vote.candidate) {\n                data.candidate = {\n                  connect: {\n                    id: vote.candidate\n                  }\n                };\n              } // Record vote\n\n\n              _context27.next = 14;\n              return ctx.db.mutation.createVote({\n                data: data\n              });\n\n            case 14:\n              return _context27.abrupt(\"return\", {\n                message: \"Thank you for voting\"\n              });\n\n            case 15:\n            case \"end\":\n              return _context27.stop();\n          }\n        }\n      }, _callee27);\n    }))();\n  },\n  createTrail: function createTrail(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee28() {\n      var trail, featuredImage, newFeaturedImage, filteredTrail, data, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee28$(_context28) {\n        while (1) {\n          switch (_context28.prev = _context28.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context28.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              // Have proper roles to do this?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              trail = args.trail;\n              featuredImage = trail.featuredImage, newFeaturedImage = trail.newFeaturedImage, filteredTrail = _babel_runtime_helpers_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_3___default()(trail, [\"featuredImage\", \"newFeaturedImage\"]);\n              data = _objectSpread({}, filteredTrail);\n\n              if (newFeaturedImage) {\n                // New featured image submitted\n                data.featuredImage = {\n                  create: _objectSpread({}, newFeaturedImage)\n                };\n              }\n\n              _context28.next = 10;\n              return ctx.db.mutation.createTrail({\n                data: data\n              }, info);\n\n            case 10:\n              results = _context28.sent;\n              return _context28.abrupt(\"return\", {\n                message: \"Your trail has been created\"\n              });\n\n            case 12:\n            case \"end\":\n              return _context28.stop();\n          }\n        }\n      }, _callee28);\n    }))();\n  },\n  updateTrail: function updateTrail(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.mark(function _callee29() {\n      var trail, trailId, newFeaturedImage, featuredImage, filteredTrail, existingTrail, data, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_4___default.a.wrap(function _callee29$(_context29) {\n        while (1) {\n          switch (_context29.prev = _context29.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context29.next = 2;\n                break;\n              }\n\n              throw new Error(\"User must be logged in\");\n\n            case 2:\n              // Have proper roles to do this?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_13__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              trail = args.trail, trailId = args.id;\n              newFeaturedImage = trail.newFeaturedImage, featuredImage = trail.featuredImage, filteredTrail = _babel_runtime_helpers_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_3___default()(trail, [\"newFeaturedImage\", \"featuredImage\"]); // Get current trail for later comparison\n\n              _context29.next = 8;\n              return ctx.db.query.trail({\n                where: {\n                  id: trailId\n                }\n              }, info);\n\n            case 8:\n              existingTrail = _context29.sent;\n              data = _objectSpread({}, filteredTrail);\n\n              if (newFeaturedImage) {\n                // New featured image submitted\n                data.featuredImage = {\n                  upsert: {\n                    create: _objectSpread({}, newFeaturedImage),\n                    update: _objectSpread({}, newFeaturedImage)\n                  }\n                };\n              } else if (existingTrail.featuredImage && existingTrail.featuredImage.publicId && !newFeaturedImage) {\n                // Remove old featured image\n                data.featuredImage = {\n                  \"delete\": true\n                };\n              }\n\n              _context29.next = 13;\n              return ctx.db.mutation.updateTrail({\n                data: data,\n                where: {\n                  id: trailId\n                }\n              }, info);\n\n            case 13:\n              results = _context29.sent;\n              return _context29.abrupt(\"return\", {\n                message: \"Your trail has been updated\"\n              });\n\n            case 15:\n            case \"end\":\n              return _context29.stop();\n          }\n        }\n      }, _callee29);\n    }))();\n  }\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (Mutation);\n\n//# sourceURL=webpack:///./src/resolvers/Mutation.js?");

/***/ }),

/***/ "./src/resolvers/Query.js":
/*!********************************!*\
  !*** ./src/resolvers/Query.js ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"@babel/runtime/regenerator\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"@babel/runtime/helpers/defineProperty\");\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ \"@babel/runtime/helpers/asyncToGenerator\");\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var graphql_binding__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! graphql-binding */ \"graphql-binding\");\n/* harmony import */ var graphql_binding__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(graphql_binding__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils */ \"./src/utils/index.js\");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../config */ \"./src/config.js\");\n\n\n\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default()(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n\n\n\nvar Query = {\n  myself: function myself(parent, args, ctx, info) {\n    // console.log(ctx);\n    // Check if there is a current user\n    if (!ctx.req.userId) {\n      return null;\n    }\n\n    return ctx.db.query.user({\n      where: {\n        id: ctx.req.userId\n      }\n    }, info);\n  },\n  users: function users(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee() {\n      var query, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper account type?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountType\"])(ctx.req.user, [\"FULL\", \"ASSOCIATE\", \"EMERITUS\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]); // If they do, query all the users\n\n              query = {\n                orderBy: \"firstName_ASC\",\n                where: {}\n              };\n\n              if (args.role && args.role.length) {\n                query.where = {\n                  role_in: args.role\n                };\n              }\n\n              if (args.accountStatus && args.accountStatus.length) {\n                query.where = _objectSpread(_objectSpread({}, query.where), {}, {\n                  accountStatus_in: args.accountStatus\n                });\n              }\n\n              if (args.accountType && args.accountType.length) {\n                query.where = _objectSpread(_objectSpread({}, query.where), {}, {\n                  accountType_in: args.accountType\n                });\n              }\n\n              if (args.office && args.office.length) {\n                query.where = _objectSpread(_objectSpread({}, query.where), {}, {\n                  office_in: args.office\n                });\n              }\n\n              if (args.title && args.title.length) {\n                query.where = _objectSpread(_objectSpread({}, query.where), {}, {\n                  title_in: args.title\n                }); // query.where = {\n                //   AND: [\n                //     { accountType_in: args.accountType, },\n                //     { accountStatus_in: args.accountStatus, },\n                //     { role_in: args.role, },\n                //     { office_in: args.office, },\n                //     { title_in: args.title, },\n                //   ],\n                // };\n              } // Sorting?\n              // if (args.orderBy && args.orderBy.length > 0) {\n              //   query.orderBy = args.orderBy[0];\n              // }\n\n\n              _context.next = 12;\n              return ctx.db.query.users(query, info);\n\n            case 12:\n              results = _context.sent;\n              results.sort(function (a, b) {\n                return a.lastName > b.lastName ? 1 : -1;\n              });\n              return _context.abrupt(\"return\", results);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  user: function user(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee2() {\n      var user;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context2.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              if (args.username && args.username !== ctx.req.user.username) {\n                // Requesting user has proper account type?\n                Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountType\"])(ctx.req.user, [\"FULL\", \"ASSOCIATE\", \"EMERITUS\"]); // Requesting user has proper account status?\n\n                Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              } // If they do, query the user\n\n\n              if (!(args.username && args.username !== \"self\")) {\n                _context2.next = 12;\n                break;\n              }\n\n              _context2.next = 6;\n              return ctx.db.query.user({\n                where: {\n                  username: args.username\n                }\n              }, info);\n\n            case 6:\n              user = _context2.sent;\n\n              if (!user) {\n                _context2.next = 11;\n                break;\n              }\n\n              return _context2.abrupt(\"return\", user);\n\n            case 11:\n              throw new Error(\"User cannot be found\");\n\n            case 12:\n              return _context2.abrupt(\"return\", ctx.db.query.user({\n                where: {\n                  id: ctx.req.userId\n                }\n              }, info));\n\n            case 13:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }))();\n  },\n  getRegistration: function getRegistration(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee3() {\n      var registration;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return ctx.db.query.registrations({\n                where: {\n                  token: args.token,\n                  tokenExpiry_gte: Date.now() - _utils__WEBPACK_IMPORTED_MODULE_4__[\"resetTokenTimeoutInMs\"]\n                },\n                first: 1\n              }, info);\n\n            case 2:\n              registration = _context3.sent;\n\n              if (registration) {\n                _context3.next = 5;\n                break;\n              }\n\n              throw new Error(\"Token invalid or expired, please register again.\");\n\n            case 5:\n              if (!(registration.length <= 0)) {\n                _context3.next = 7;\n                break;\n              }\n\n              throw new Error(\"Registration invalid, please register again.\");\n\n            case 7:\n              return _context3.abrupt(\"return\", registration[0]);\n\n            case 8:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }))();\n  },\n  getDuesLastReceived: function getDuesLastReceived(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee4() {\n      var userQuery, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context4.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper role?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\"]); // Requesting user has proper account type?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountType\"])(ctx.req.user, [\"FULL\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              userQuery = args.username === \"self\" ? {\n                id: ctx.req.userId\n              } : {\n                username: args.username\n              }; // If they do, query the user\n\n              _context4.next = 8;\n              return ctx.db.query.membershipLogItems({\n                where: {\n                  AND: [{\n                    user: userQuery\n                  }, {\n                    messageCode: \"DUES_PAID\"\n                  }]\n                },\n                orderBy: \"createdAt_DESC\",\n                first: 1\n              }, info);\n\n            case 8:\n              results = _context4.sent;\n              return _context4.abrupt(\"return\", {\n                time: results.length > 0 ? results[0].time : null\n              });\n\n            case 10:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }))();\n  },\n  getOfficer: function getOfficer(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee5() {\n      var results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context5.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper account type?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountType\"])(ctx.req.user, [\"FULL\", \"ASSOCIATE\", \"EMERITUS\"]); // // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]); // If they do, query the officer\n\n              _context5.next = 6;\n              return ctx.db.query.users({\n                where: {\n                  office: args.office\n                }\n              }, info);\n\n            case 6:\n              results = _context5.sent;\n              return _context5.abrupt(\"return\", results.length > 0 ? results[0] : {});\n\n            case 8:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }))();\n  },\n  getMembers: function getMembers(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee6() {\n      var results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context6.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper account type?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountType\"])(ctx.req.user, [\"FULL\", \"ASSOCIATE\", \"EMERITUS\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]); // If they do, query all the members\n\n              _context6.next = 6;\n              return ctx.db.query.users({\n                where: {\n                  AND: [{\n                    accountStatus: \"ACTIVE\"\n                  }, {\n                    accountType_in: args.accountTypes\n                  }, {\n                    office: null\n                  } // No officers\n                  ]\n                },\n                orderBy: \"firstName_ASC\"\n              }, info);\n\n            case 6:\n              results = _context6.sent;\n              // Sort by lastName then firstName\n              results.sort(function (a, b) {\n                return a.lastName > b.lastName ? 1 : -1;\n              });\n              return _context6.abrupt(\"return\", results);\n\n            case 9:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }))();\n  },\n  getRunLeaders: function getRunLeaders(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee7() {\n      var results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context7.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper role?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\"]); // Requesting user has proper account type?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountType\"])(ctx.req.user, [\"FULL\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]); // Return all run leaders\n\n              _context7.next = 7;\n              return ctx.db.query.users({\n                where: {\n                  AND: [{\n                    accountStatus: \"ACTIVE\"\n                  }, {\n                    accountType: \"FULL\"\n                  }, {\n                    role_in: [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\", \"RUN_LEADER\"]\n                  }]\n                },\n                orderBy: \"firstName_ASC\"\n              }, info);\n\n            case 7:\n              results = _context7.sent;\n              // Sort by lastName then firstName\n              results.sort(function (a, b) {\n                return a.lastName > b.lastName ? 1 : -1;\n              });\n              return _context7.abrupt(\"return\", results);\n\n            case 10:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }))();\n  },\n  getMessageRecipients: function getMessageRecipients(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee8() {\n      var user, members, query, results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context8.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              user = ctx.req.user;\n              members = [\"FULL\", \"ASSOCIATE\", \"EMERITUS\"];\n              query = {\n                where: {},\n                orderBy: \"firstName_ASC\"\n              };\n\n              if (Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(user, [\"ACTIVE\"], false)) {\n                _context8.next = 7;\n                break;\n              }\n\n              return _context8.abrupt(\"return\", []);\n\n            case 7:\n              if (!Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasRole\"])(user, [\"ADMIN\", \"OFFICER\"], false)) {\n                _context8.next = 11;\n                break;\n              }\n\n              query.where = {\n                accountType_in: _config__WEBPACK_IMPORTED_MODULE_5__[\"accountType\"]\n              };\n              _context8.next = 16;\n              break;\n\n            case 11:\n              if (!Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountType\"])(user, members, false)) {\n                _context8.next = 15;\n                break;\n              }\n\n              query.where = {\n                AND: [{\n                  accountStatus: \"ACTIVE\"\n                }, {\n                  accountType_in: members\n                }]\n              };\n              _context8.next = 16;\n              break;\n\n            case 15:\n              return _context8.abrupt(\"return\", []);\n\n            case 16:\n              _context8.next = 18;\n              return ctx.db.query.users(query, info);\n\n            case 18:\n              results = _context8.sent;\n              // Sort by lastName then firstName\n              results.sort(function (a, b) {\n                return a.lastName > b.lastName ? 1 : -1;\n              });\n              return _context8.abrupt(\"return\", results);\n\n            case 21:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }))();\n  },\n  getUpcomingEvents: function getUpcomingEvents(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee9() {\n      var query;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context9.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper account status?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              query = {\n                where: {\n                  startTime_gte: new Date().toISOString()\n                },\n                orderBy: \"startTime_ASC\"\n              };\n\n              if (args.count) {\n                query.first = args.count;\n              } // If they do, query all the users\n\n\n              return _context9.abrupt(\"return\", ctx.db.query.events(query, info));\n\n            case 6:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9);\n    }))();\n  },\n  getUserEvents: function getUserEvents(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee10() {\n      var userQuery;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context10.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper role?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\"]); // Requesting user has proper account type?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              userQuery = args.username === \"self\" ? {\n                id: ctx.req.userId\n              } : {\n                username: args.username\n              };\n\n              if (!args.eventType) {\n                _context10.next = 7;\n                break;\n              }\n\n              return _context10.abrupt(\"return\", ctx.db.query.events({\n                where: {\n                  AND: [{\n                    type: args.eventType\n                  }, {\n                    startTime_lte: new Date().toISOString()\n                  }, {\n                    rsvps_some: {\n                      member: userQuery\n                    }\n                  }]\n                },\n                orderBy: \"startTime_DESC\"\n              }, info));\n\n            case 7:\n              return _context10.abrupt(\"return\", ctx.db.query.events({\n                where: {\n                  AND: [{\n                    startTime_lte: new Date().toISOString()\n                  }, {\n                    rsvps_some: {\n                      member: userQuery\n                    }\n                  }]\n                },\n                orderBy: \"startTime_DESC\"\n              }, info));\n\n            case 8:\n            case \"end\":\n              return _context10.stop();\n          }\n        }\n      }, _callee10);\n    }))();\n  },\n  getPastEvents: function getPastEvents(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee11() {\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context11.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper account status?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]); // If they do, query all the users\n\n              return _context11.abrupt(\"return\", ctx.db.query.events({\n                where: {\n                  startTime_lte: new Date().toISOString()\n                },\n                orderBy: \"startTime_DESC\"\n              }, info));\n\n            case 4:\n            case \"end\":\n              return _context11.stop();\n          }\n        }\n      }, _callee11);\n    }))();\n  },\n  getEvent: function getEvent(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee12() {\n      var result;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee12$(_context12) {\n        while (1) {\n          switch (_context12.prev = _context12.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context12.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper account status?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              _context12.next = 5;\n              return ctx.db.query.event({\n                where: {\n                  id: args.eventId\n                }\n              }, info);\n\n            case 5:\n              result = _context12.sent;\n\n              if (result) {\n                _context12.next = 8;\n                break;\n              }\n\n              throw new Error(\"Event cannot be found\");\n\n            case 8:\n              return _context12.abrupt(\"return\", result);\n\n            case 9:\n            case \"end\":\n              return _context12.stop();\n          }\n        }\n      }, _callee12);\n    }))();\n  },\n  getNextEvent: function getNextEvent(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee13() {\n      var results;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee13$(_context13) {\n        while (1) {\n          switch (_context13.prev = _context13.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context13.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper account status?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              _context13.prev = 3;\n              _context13.next = 6;\n              return ctx.db.query.events({\n                where: {\n                  startTime_gte: new Date().toISOString()\n                },\n                orderBy: \"startTime_ASC\",\n                first: 1\n              }, info);\n\n            case 6:\n              results = _context13.sent;\n              return _context13.abrupt(\"return\", results.length > 0 ? results[0] : null);\n\n            case 10:\n              _context13.prev = 10;\n              _context13.t0 = _context13[\"catch\"](3);\n              throw new Error(_context13.t0);\n\n            case 13:\n            case \"end\":\n              return _context13.stop();\n          }\n        }\n      }, _callee13, null, [[3, 10]]);\n    }))();\n  },\n  // async getMyNextEvent(parent, args, ctx, info) {\n  //   // Logged in?\n  //   if (!ctx.req.userId) {\n  //     throw new Error(\"You must be logged in\");\n  //   }\n  //   // Requesting user has proper account status?\n  //   hasAccountStatus(ctx.req.user, [\"ACTIVE\"]);\n  //   try {\n  //     // const results = await ctx.db.query.user(\n  //     //   {\n  //     //     where: {\n  //     //       startTime_gte: new Date().toISOString(),\n  //     //       rsvps_every: {\n  //     //         member: {\n  //     //           id: ctx.req.userId\n  //     //         }\n  //     //       }\n  //     //     },\n  //     //     orderBy: \"startTime_ASC\",\n  //     //     first: 1,\n  //     //   },\n  //     //   info\n  //     // );\n  //     const results = await ctx.db.query\n  //     console.log(results);\n  //     return results.length > 0 ? results[0]: {};\n  //   } catch (e) {\n  //     throw new Error(e);\n  //   }\n  // },\n  getTrails: function getTrails(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee14() {\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee14$(_context14) {\n        while (1) {\n          switch (_context14.prev = _context14.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context14.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper account status?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]); // If they do, query all the users\n\n              return _context14.abrupt(\"return\", ctx.db.query.trails({}, info));\n\n            case 4:\n            case \"end\":\n              return _context14.stop();\n          }\n        }\n      }, _callee14);\n    }))();\n  },\n  getTrail: function getTrail(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee15() {\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee15$(_context15) {\n        while (1) {\n          switch (_context15.prev = _context15.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context15.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper account status?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\", \"RUN_LEADER\"]);\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountType\"])(ctx.req.user, [\"FULL\"]); // If they do, query all the users\n\n              return _context15.abrupt(\"return\", ctx.db.query.trail({\n                where: {\n                  slug: args.slug\n                }\n              }, info));\n\n            case 6:\n            case \"end\":\n              return _context15.stop();\n          }\n        }\n      }, _callee15);\n    }))();\n  },\n  electionCandidates: function electionCandidates(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee16() {\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee16$(_context16) {\n        while (1) {\n          switch (_context16.prev = _context16.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context16.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper role?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]); // If they do, query all the users\n\n              return _context16.abrupt(\"return\", ctx.db.query.users({\n                where: {\n                  role_in: args.roles,\n                  accountStatus: args.accountStatus\n                }\n              }, info));\n\n            case 5:\n            case \"end\":\n              return _context16.stop();\n          }\n        }\n      }, _callee16);\n    }))();\n  },\n  getActiveElections: function getActiveElections(parent, args, ctx, info) {\n    // Logged in?\n    if (!ctx.req.userId) {\n      throw new Error(\"You must be logged in\");\n    } // Requesting user has proper account type?\n\n\n    Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountType\"])(ctx.req.user, [\"FULL\"]); // Requesting user has proper account status?\n\n    Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n    return ctx.db.query.elections({\n      where: {\n        AND: [{\n          startTime_lte: new Date().toISOString()\n        }, {\n          endTime_gt: new Date().toISOString()\n        }]\n      },\n      orderBy: \"endTime_ASC\"\n    }, info);\n  },\n  getActiveElectionsWithResults: function getActiveElectionsWithResults(parent, args, ctx, info) {\n    // Logged in?\n    if (!ctx.req.userId) {\n      throw new Error(\"You must be logged in\");\n    } // Requesting user has proper role?\n\n\n    Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\"]); // Requesting user has proper account status?\n\n    Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n    return ctx.db.query.elections({\n      where: {\n        AND: [{\n          startTime_lte: new Date().toISOString()\n        }, {\n          endTime_gt: new Date().toISOString()\n        }]\n      },\n      orderBy: \"endTime_ASC\"\n    }, info);\n  },\n  getElection: function getElection(parent, args, ctx, info) {\n    // Logged in?\n    if (!ctx.req.userId) {\n      throw new Error(\"You must be logged in\");\n    } // Requesting user has proper account type?\n\n\n    Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountType\"])(ctx.req.user, [\"FULL\"]); // Requesting user has proper account status?\n\n    Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n    return ctx.db.query.election({\n      where: {\n        id: args.id\n      }\n    }, info);\n  },\n  getUserVote: function getUserVote(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee17() {\n      var votes;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee17$(_context17) {\n        while (1) {\n          switch (_context17.prev = _context17.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context17.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              // Requesting user has proper account type?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountType\"])(ctx.req.user, [\"FULL\"]); // Requesting user has proper account status?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]);\n              _context17.next = 6;\n              return ctx.db.query.votes({\n                where: {\n                  AND: [{\n                    ballot: {\n                      id: args.ballot\n                    }\n                  }, {\n                    voter: {\n                      id: ctx.req.userId\n                    }\n                  }]\n                },\n                first: true\n              }, info);\n\n            case 6:\n              votes = _context17.sent;\n              return _context17.abrupt(\"return\", votes);\n\n            case 8:\n            case \"end\":\n              return _context17.stop();\n          }\n        }\n      }, _callee17);\n    }))();\n  },\n  // async adminStats(parent, args, ctx, info) {\n  //   // Logged in?\n  //   if (!ctx.req.userId) {\n  //     throw new Error(\"You must be logged in\");\n  //   }\n  //   // Requesting user has proper role?\n  //   hasRole(ctx.req.user, [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\"]);\n  //   // Requesting user has proper account type?\n  //   hasAccountType(ctx.req.user, [\"FULL\"]);\n  //   // Requesting user has proper account status?\n  //   hasAccountStatus(ctx.req.user, [\"ACTIVE\"]);\n  //   return ctx.db.query.votes(\n  //     {\n  //       where: {\n  //         AND: [\n  //           { ballot: { id: args.ballot } },\n  //           { voter: { id: ctx.req.userId } }\n  //         ]\n  //       },\n  //       first: true\n  //     },\n  //     info\n  //   );\n  //   const [\n  //     activeFullMembers,\n  //     pastDueFullMembers,\n  //     delinquentFullMembers,\n  //     removedFullMembers,\n  //     resignedFullMembers,\n  //     inactiveFullMembers,\n  //     limitedGuestMembers,\n  //     lockedGuestMembers,\n  //     emeritusMembers,\n  //     deceasedMembers,\n  //     associateMembers,\n  //     guestMembers,\n  //     charterMembers,\n  //     fullMembersLastYear,\n  //     newFullMembersThisYear,\n  //     neededForQuorum,\n  //     neededToPassMotion,\n  //     neededToVoteOnNewMember,\n  //     newFullMembersAllowed,\n  //     fullMembersAllowed\n  //   ] = Promise.all([\n  //     ctx.db.query.usersConnection(\n  //       {\n  //         where: {}\n  //       },\n  //       info\n  //     )\n  //   ]);\n  //   const results = {};\n  //   return {\n  //     activeFullMembers,\n  //     pastDueFullMembers,\n  //     delinquentFullMembers,\n  //     removedFullMembers,\n  //     resignedFullMembers,\n  //     inactiveFullMembers,\n  //     limitedGuestMembers,\n  //     lockedGuestMembers,\n  //     emeritusMembers,\n  //     deceasedMembers,\n  //     associateMembers,\n  //     guestMembers,\n  //     charterMembers,\n  //     fullMembersLastYear,\n  //     newFullMembersThisYear,\n  //     neededForQuorum,\n  //     neededToPassMotion,\n  //     neededToVoteOnNewMember,\n  //     newFullMembersAllowed,\n  //     fullMembersAllowed\n  //   };\n  // },\n  // async activeMembersPerYear(parent, args, ctx, info) {\n  //   // Logged in?\n  //   if (!ctx.req.userId) {\n  //     throw new Error(\"You must be logged in\");\n  //   }\n  //   hasRole(ctx.req.user, [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\"]);\n  //   // Requesting user has proper account type?\n  //   hasAccountType(ctx.req.user, [\"FULL\"]);\n  //   // Requesting user has proper account status?\n  //   hasAccountStatus(ctx.req.user, [\"ACTIVE\"]);\n  //   return ctx.db.query.users(\n  //     {\n  //       where: {}\n  //     },\n  //     info\n  //   );\n  //   return [\n  //     {\n  //       year,\n  //       count\n  //     }\n  //   ];\n  // },\n  // async guestsWithLockedAccounts(parent, args, ctx, info) {\n  //   // Logged in?\n  //   if (!ctx.req.userId) {\n  //     throw new Error(\"You must be logged in\");\n  //   }\n  //   hasRole(ctx.req.user, [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\"]);\n  //   // Requesting user has proper account type?\n  //   hasAccountType(ctx.req.user, [\"FULL\"]);\n  //   // Requesting user has proper account status?\n  //   hasAccountStatus(ctx.req.user, [\"ACTIVE\"]);\n  //   return ctx.db.query.users(\n  //     {\n  //       where: {\n  //         AND: [{ accountType: \"GUEST\" }, { accountStatus: \"LOCKED\" }]\n  //       }\n  //     },\n  //     info\n  //   );\n  // },\n  // async guestsAskedToJoin(parent, args, ctx, info) {\n  //   // Logged in?\n  //   if (!ctx.req.userId) {\n  //     throw new Error(\"You must be logged in\");\n  //   }\n  //   hasRole(ctx.req.user, [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\"]);\n  //   // Requesting user has proper account type?\n  //   hasAccountType(ctx.req.user, [\"FULL\"]);\n  //   // Requesting user has proper account status?\n  //   hasAccountStatus(ctx.req.user, [\"ACTIVE\"]);\n  //   return ctx.db.query.users(\n  //     {\n  //       where: {\n  //         AND: [{ accountType: \"GUEST\" }, { accountStatus: \"LIMITED\" }]\n  //       }\n  //     },\n  //     info\n  //   );\n  // },\n  // async guestsEligibleForMembership(parent, args, ctx, info) {\n  //   // Logged in?\n  //   if (!ctx.req.userId) {\n  //     throw new Error(\"You must be logged in\");\n  //   }\n  //   hasRole(ctx.req.user, [\"ADMIN\", \"OFFICER\", \"RUN_MASTER\"]);\n  //   // Requesting user has proper account type?\n  //   hasAccountType(ctx.req.user, [\"FULL\"]);\n  //   // Requesting user has proper account status?\n  //   hasAccountStatus(ctx.req.user, [\"ACTIVE\"]);\n  //   // TODO: Has attended 1 run\n  //   // TODO: Has attended 1 meeting\n  //   const results = ctx.db.query.users({\n  //     where: {\n  //       AND: [\n  //         { accountType: \"GUEST\" },\n  //         { accountStatus: \"ACTIVE\" },\n  //         {\n  //           eventsRSVPd_some: {\n  //             where: {\n  //               type: {}\n  //             }\n  //           }\n  //         }\n  //       ]\n  //     }\n  //   });\n  //   // Filter over 18\n  //   // Filter at least 1 run\n  //   // Filter at least 1 meeting\n  // }\n  getMembershipLogItems: function getMembershipLogItems(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee18() {\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee18$(_context18) {\n        while (1) {\n          switch (_context18.prev = _context18.next) {\n            case 0:\n              if (ctx.req.userId) {\n                _context18.next = 2;\n                break;\n              }\n\n              throw new Error(\"You must be logged in\");\n\n            case 2:\n              if (Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountType\"])(ctx.req.user, [\"FULL\", \"ASSOCIATE\"], false)) {\n                _context18.next = 4;\n                break;\n              }\n\n              return _context18.abrupt(\"return\", []);\n\n            case 4:\n              if (!(args.username.toLowerCase() === \"self\")) {\n                _context18.next = 6;\n                break;\n              }\n\n              return _context18.abrupt(\"return\", ctx.db.query.membershipLogItems({\n                where: {\n                  AND: [{\n                    messageCode: args.messageCode\n                  }, {\n                    user: {\n                      id: ctx.req.userId\n                    }\n                  }]\n                },\n                orderBy: \"time_DESC\"\n              }, info));\n\n            case 6:\n              // Requesting user has proper account status?\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasAccountStatus\"])(ctx.req.user, [\"ACTIVE\"]); // Requesting user has proper role?\n\n              Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"hasRole\"])(ctx.req.user, [\"ADMIN\", \"OFFICER\"]);\n              return _context18.abrupt(\"return\", ctx.db.query.membershipLogItems({\n                where: {\n                  AND: [{\n                    messageCode: args.messageCode\n                  }, {\n                    user: {\n                      username: args.username\n                    }\n                  }]\n                },\n                orderBy: \"time_DESC\"\n              }, info));\n\n            case 9:\n            case \"end\":\n              return _context18.stop();\n          }\n        }\n      }, _callee18);\n    }))();\n  }\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (Query);\n\n//# sourceURL=webpack:///./src/resolvers/Query.js?");

/***/ }),

/***/ "./src/resolvers/Trail.js":
/*!********************************!*\
  !*** ./src/resolvers/Trail.js ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"@babel/runtime/regenerator\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ \"@babel/runtime/helpers/asyncToGenerator\");\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils */ \"./src/utils/index.js\");\n/* harmony import */ var date_fns__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! date-fns */ \"date-fns\");\n/* harmony import */ var date_fns__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(date_fns__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nvar Trail = {\n  // Pattern borrowed from playbook:\n  // https://www.prisma.io/tutorials/a-guide-to-common-resolver-patterns-ct08/#scenario:-add-a-custom/computed-field-to-a-prisma-model-via-the-application-schema-prisma-bindings\n  avgDifficulty: function avgDifficulty(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee() {\n      var reports, scale, counts, avg, entries, avgDifficulty;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return ctx.db.query.runReports({\n                where: {\n                  trail: {\n                    id: parent.id\n                  }\n                }\n              });\n\n            case 2:\n              reports = _context.sent;\n              // Convert to array\n              scale = {\n                UNKNOWN: 0,\n                BEGINNER: 1,\n                INTERMEDIATE: 2,\n                ADVANCED: 3\n              }; // Determine total\n\n              counts = reports.reduce(function (accumulator, report) {\n                return scale[report.difficulty] + accumulator;\n              }, 0);\n\n              if (!counts) {\n                _context.next = 10;\n                break;\n              }\n\n              avg = Math.round(counts / reports.length);\n              entries = Object.entries(scale); // console.log(\"entries\", entries);\n\n              avgDifficulty = entries.find(function (entry) {\n                return avg === entry[1];\n              });\n              return _context.abrupt(\"return\", avgDifficulty[0]);\n\n            case 10:\n              return _context.abrupt(\"return\", \"UNKNOWN\");\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  avgRatings: function avgRatings(parent, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee2() {\n      var reports, counts, avgRatings;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return ctx.db.query.runReports({\n                where: {\n                  trail: {\n                    id: parent.id\n                  }\n                }\n              });\n\n            case 2:\n              reports = _context2.sent;\n              // Determine total\n              counts = reports.reduce(function (accumulator, report) {\n                return report.rating + accumulator;\n              }, 0);\n\n              if (!counts) {\n                _context2.next = 7;\n                break;\n              }\n\n              avgRatings = (counts / reports.length).toPrecision(3);\n              return _context2.abrupt(\"return\", avgRatings);\n\n            case 7:\n              return _context2.abrupt(\"return\", 0);\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }))();\n  },\n  currentConditions: function currentConditions(_ref, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee3() {\n      var id, conditions;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              id = _ref.id;\n              _context3.next = 3;\n              return ctx.db.query.conditions({\n                where: {\n                  report: {\n                    AND: [{\n                      trail: {\n                        id: id\n                      }\n                    }, {\n                      startTime_lte: new Date(Date.now() - _utils__WEBPACK_IMPORTED_MODULE_2__[\"monthInMs\"])\n                    }]\n                  }\n                },\n                first: 1\n              });\n\n            case 3:\n              conditions = _context3.sent;\n\n              if (!(conditions.length > 0)) {\n                _context3.next = 6;\n                break;\n              }\n\n              return _context3.abrupt(\"return\", conditions[0].status);\n\n            case 6:\n              return _context3.abrupt(\"return\", \"UNKNOWN\");\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }))();\n  },\n  conditionsLastReported: function conditionsLastReported(_ref2, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee4() {\n      var id, conditions;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              id = _ref2.id;\n              _context4.next = 3;\n              return ctx.db.query.conditions({\n                where: {\n                  report: {\n                    AND: [{\n                      trail: {\n                        id: id\n                      }\n                    }, {\n                      startTime_lte: new Date(Date.now() - _utils__WEBPACK_IMPORTED_MODULE_2__[\"monthInMs\"])\n                    }]\n                  }\n                },\n                first: 1\n              });\n\n            case 3:\n              conditions = _context4.sent;\n\n              if (!(conditions.length > 0)) {\n                _context4.next = 6;\n                break;\n              }\n\n              return _context4.abrupt(\"return\", conditions[0].dateReported);\n\n            case 6:\n              return _context4.abrupt(\"return\", null);\n\n            case 7:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }))();\n  },\n  favoriteCount: function favoriteCount(_ref3, args, ctx, info) {\n    return _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee5() {\n      var id, reports;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              id = _ref3.id;\n              _context5.next = 3;\n              return ctx.db.query.runReports({\n                where: {\n                  AND: [{\n                    trail: {\n                      id: id\n                    }\n                  }, {\n                    favorite: true\n                  }]\n                }\n              });\n\n            case 3:\n              reports = _context5.sent;\n              return _context5.abrupt(\"return\", reports.length);\n\n            case 5:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }))();\n  }\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (Trail);\n\n//# sourceURL=webpack:///./src/resolvers/Trail.js?");

/***/ }),

/***/ "./src/utils/index.js":
/*!****************************!*\
  !*** ./src/utils/index.js ***!
  \****************************/
/*! exports provided: hasRole, hasAccountStatus, hasAccountType, hasRoleOrIsSelf, isSelf, yearInMs, monthInMs, resetTokenTimeoutInMs, getUploadLocation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"hasRole\", function() { return hasRole; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"hasAccountStatus\", function() { return hasAccountStatus; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"hasAccountType\", function() { return hasAccountType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"hasRoleOrIsSelf\", function() { return hasRoleOrIsSelf; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSelf\", function() { return isSelf; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"yearInMs\", function() { return yearInMs; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"monthInMs\", function() { return monthInMs; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"resetTokenTimeoutInMs\", function() { return resetTokenTimeoutInMs; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getUploadLocation\", function() { return getUploadLocation; });\nvar hasRole = function hasRole(user, rolesNeeded) {\n  var shouldThrow = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var matchedRoles = rolesNeeded.includes(user.role);\n\n  if (!matchedRoles && shouldThrow) {\n    throw new Error(\"You do not have the necessary role\\n      : \".concat(rolesNeeded, \"\\n      You Have\\n      : \").concat(user.role, \"\\n    \"));\n  }\n\n  return matchedRoles;\n};\nvar hasAccountStatus = function hasAccountStatus(user, statusNeeded) {\n  var shouldThrow = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var matchedStatus = statusNeeded.includes(user.accountStatus);\n\n  if (!matchedStatus && shouldThrow) {\n    throw new Error(\"You do not have the necessary account status\\n      : \".concat(statusNeeded, \"\\n      You Have\\n      : \").concat(user.accountStatus, \"\\n    \"));\n  }\n\n  return matchedStatus;\n};\nvar hasAccountType = function hasAccountType(user, typeNeeded) {\n  var shouldThrow = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var matchedType = typeNeeded.includes(user.accountType);\n\n  if (!matchedType && shouldThrow) {\n    throw new Error(\"You do not have the necessary account type\\n      : \".concat(typeNeeded, \"\\n      You Have\\n      : \").concat(user.accountType, \"\\n    \"));\n  }\n\n  return matchedType;\n};\nvar hasRoleOrIsSelf = function hasRoleOrIsSelf(currentUser, rolesNeeded, idInQuestion) {\n  var shouldThrow = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n  var result = hasRole(currentUser, rolesNeeded, false) || isSelf(currentUser.id, idInQuestion, false);\n\n  if (!result && shouldThrow) {\n    throw new Error(\"You must be an admin to do this\");\n  }\n};\nvar isSelf = function isSelf(currentUser, idInQuestion) {\n  var shouldThrow = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var result = currentUser.id === idInQuestion; // console.log(\"current user id\", currentUser.id);\n\n  if (!result && shouldThrow) {\n    throw new Error(\"You can only update your own information\");\n  }\n\n  return result;\n};\nvar yearInMs = 1000 * 60 * 60 * 24 * 365; // 1 year\n\nvar monthInMs = 1000 * 60 * 60 * 24 * 30;\nvar resetTokenTimeoutInMs = 3600000; // 1 hour\n\nvar getUploadLocation = function getUploadLocation(appendage) {\n  return  true ? \"dev_\".concat(appendage) : undefined;\n};\n\n//# sourceURL=webpack:///./src/utils/index.js?");

/***/ }),

/***/ "@babel/runtime/helpers/asyncToGenerator":
/*!**********************************************************!*\
  !*** external "@babel/runtime/helpers/asyncToGenerator" ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"@babel/runtime/helpers/asyncToGenerator\");\n\n//# sourceURL=webpack:///external_%22@babel/runtime/helpers/asyncToGenerator%22?");

/***/ }),

/***/ "@babel/runtime/helpers/defineProperty":
/*!********************************************************!*\
  !*** external "@babel/runtime/helpers/defineProperty" ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"@babel/runtime/helpers/defineProperty\");\n\n//# sourceURL=webpack:///external_%22@babel/runtime/helpers/defineProperty%22?");

/***/ }),

/***/ "@babel/runtime/helpers/objectWithoutProperties":
/*!*****************************************************************!*\
  !*** external "@babel/runtime/helpers/objectWithoutProperties" ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"@babel/runtime/helpers/objectWithoutProperties\");\n\n//# sourceURL=webpack:///external_%22@babel/runtime/helpers/objectWithoutProperties%22?");

/***/ }),

/***/ "@babel/runtime/helpers/slicedToArray":
/*!*******************************************************!*\
  !*** external "@babel/runtime/helpers/slicedToArray" ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"@babel/runtime/helpers/slicedToArray\");\n\n//# sourceURL=webpack:///external_%22@babel/runtime/helpers/slicedToArray%22?");

/***/ }),

/***/ "@babel/runtime/helpers/toConsumableArray":
/*!***********************************************************!*\
  !*** external "@babel/runtime/helpers/toConsumableArray" ***!
  \***********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"@babel/runtime/helpers/toConsumableArray\");\n\n//# sourceURL=webpack:///external_%22@babel/runtime/helpers/toConsumableArray%22?");

/***/ }),

/***/ "@babel/runtime/regenerator":
/*!*********************************************!*\
  !*** external "@babel/runtime/regenerator" ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"@babel/runtime/regenerator\");\n\n//# sourceURL=webpack:///external_%22@babel/runtime/regenerator%22?");

/***/ }),

/***/ "@sendgrid/mail":
/*!*********************************!*\
  !*** external "@sendgrid/mail" ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"@sendgrid/mail\");\n\n//# sourceURL=webpack:///external_%22@sendgrid/mail%22?");

/***/ }),

/***/ "apollo-server-express":
/*!****************************************!*\
  !*** external "apollo-server-express" ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"apollo-server-express\");\n\n//# sourceURL=webpack:///external_%22apollo-server-express%22?");

/***/ }),

/***/ "bcryptjs":
/*!***************************!*\
  !*** external "bcryptjs" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"bcryptjs\");\n\n//# sourceURL=webpack:///external_%22bcryptjs%22?");

/***/ }),

/***/ "cloudinary":
/*!*****************************!*\
  !*** external "cloudinary" ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"cloudinary\");\n\n//# sourceURL=webpack:///external_%22cloudinary%22?");

/***/ }),

/***/ "cookie-parser":
/*!********************************!*\
  !*** external "cookie-parser" ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"cookie-parser\");\n\n//# sourceURL=webpack:///external_%22cookie-parser%22?");

/***/ }),

/***/ "cors":
/*!***********************!*\
  !*** external "cors" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"cors\");\n\n//# sourceURL=webpack:///external_%22cors%22?");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"crypto\");\n\n//# sourceURL=webpack:///external_%22crypto%22?");

/***/ }),

/***/ "date-fns":
/*!***************************!*\
  !*** external "date-fns" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"date-fns\");\n\n//# sourceURL=webpack:///external_%22date-fns%22?");

/***/ }),

/***/ "dotenv":
/*!*************************!*\
  !*** external "dotenv" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"dotenv\");\n\n//# sourceURL=webpack:///external_%22dotenv%22?");

/***/ }),

/***/ "express":
/*!**************************!*\
  !*** external "express" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"express\");\n\n//# sourceURL=webpack:///external_%22express%22?");

/***/ }),

/***/ "graphql-binding":
/*!**********************************!*\
  !*** external "graphql-binding" ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"graphql-binding\");\n\n//# sourceURL=webpack:///external_%22graphql-binding%22?");

/***/ }),

/***/ "graphql-import":
/*!*********************************!*\
  !*** external "graphql-import" ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"graphql-import\");\n\n//# sourceURL=webpack:///external_%22graphql-import%22?");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"jsonwebtoken\");\n\n//# sourceURL=webpack:///external_%22jsonwebtoken%22?");

/***/ }),

/***/ "node-fetch":
/*!*****************************!*\
  !*** external "node-fetch" ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"node-fetch\");\n\n//# sourceURL=webpack:///external_%22node-fetch%22?");

/***/ }),

/***/ "nodemailer":
/*!*****************************!*\
  !*** external "nodemailer" ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"nodemailer\");\n\n//# sourceURL=webpack:///external_%22nodemailer%22?");

/***/ }),

/***/ "prisma-binding":
/*!*********************************!*\
  !*** external "prisma-binding" ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"prisma-binding\");\n\n//# sourceURL=webpack:///external_%22prisma-binding%22?");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"util\");\n\n//# sourceURL=webpack:///external_%22util%22?");

/***/ })

/******/ });